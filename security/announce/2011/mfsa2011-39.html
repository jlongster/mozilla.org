<?php

$html_title = 'MFSA 2011-39: Defense against multiple Location headers due to CRLF Injection';

$menu = array(
    'id' => 'default',
);

$extra_headers = '
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="contents"
      href="/security/known-vulnerabilities.html"
      title="Known Vulnerabilities in Mozilla Products">
<link rel="up"
      href="/security/announce/"
      title="Mozilla Foundation Security Advisories">
<style type="text/css">
  .label { width: 8em; font-weight: bold; float: left;}
</style>

';

require_once "{$config['file_root']}/includes/header.inc.php";

?>

<p class="crumbs"><em>You are here:</em>
<a href="/security/">Security Center</a>
&gt; <a href="/security/announce/">Mozilla Foundation Security Advisories</a>
&gt; <strong><abbr title="Mozilla Foundation Security Advisory">MFSA</abbr>
2011-39</strong></p>

<h1>Mozilla Foundation Security Advisory 2011-39</h1>

<p>
<span class="label">Title:</span>      Defense against multiple Location headers due to CRLF Injection<br>
<span class="label">Impact:</span>     Moderate<br>
<span class="label">Announced:</span>  September 27, 2011<br>
<span class="label">Reporter:</span>   Ian Graham<br>
<span class="label">Products:</span>   Firefox, Thunderbird, SeaMonkey<br>
<br>
<span class="label">Fixed in:</span>   Firefox 7.0<br>
<span class="label">&nbsp;</span>      Firefox 3.6.23<br>
<span class="label">&nbsp;</span>      Thunderbird 7.0<br>
<span class="label">&nbsp;</span>      SeaMonkey 2.4<br>
</p>


<h3>Description</h3>

<p><strong>Ian Graham</strong> of Citrix Online reported that when multiple
<code>Location</code> headers were present in a redirect response 
Mozilla behavior differed from other browsers: Mozilla would use the second
<code>Location</code> header while Chrome and Internet Explorer would use
the first. Two copies of this header with different values could be a symptom
of a CRLF injection attack against a vulnerable server. Most commonly it is
the <code>Location</code> header itself that is vulnerable to the response
splitting and therefore the copy preferred by Mozilla is more likely to be
the malicious one. It is possible, however, that the first copy was the
injected one depending on the nature of the server vulnerability.
</p>

<p>The Mozilla browser engine has been changed to treat two copies of this
header with different values as an error condition. The same has been done
with the headers <code>Content-Length</code> and <code>Content-Disposition</code>
</p>

<h3>References</h3>

<ul>
  <li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=655389">https://bugzilla.mozilla.org/show_bug.cgi?id=655389</a></li>
  <li><a class="ex-ref" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3000">CVE-2011-3000</a></li>
</ul>

<?
require_once "{$config['file_root']}/includes/footer.inc.php";
?>

