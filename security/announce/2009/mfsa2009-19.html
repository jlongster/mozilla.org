<?php

$html_title = 'MFSA 2009-19: Same-origin violations in XMLHttpRequest and XPCNativeWrapper.toString';

$menu = array(
    'id' => 'security',
);

$extra_headers = '
<meta http-equiv="Content-Language" content="en">
<meta http-equiv="Content-Style-Type" content="text/css">
<link rel="contents"
href="/security/known-vulnerabilities.html"
title="Known Vulnerabilities in Mozilla Products">
<link rel="up"
href="/security/announce/"
title="Mozilla Foundation Security Advisories">
';

$extra_style = '
<style type="text/css">
.label { width: 8em; font-weight: bold; float: left;}
</style>

';

require_once "{$config['file_root']}/includes/header-2010.inc.php"

?>
<div id="main-content">
	<h1 id="page-title"><?php echo $page_title; ?></h1>

<p class="crumbs"><em>You are here:</em>
<a href="/security/">Security Center</a>
&gt; <a href="/security/announce/">Mozilla Foundation Security Advisories</a>
&gt; <strong><abbr title="Mozilla Foundation Security Advisory">MFSA</abbr>
2009-19</strong></p>

<h1>Mozilla Foundation Security Advisory 2009-19</h1>

<p>
<span class="label">Title:</span>      Same-origin violations in XMLHttpRequest and XPCNativeWrapper.toString<br>
<span class="label">Impact:</span>     High<br>
<span class="label">Announced:</span>  April 21, 2009<br>
<span class="label">Reporter:</span>   moz_bug_r_a4<br>
<span class="label">Products:</span>   Firefox, Thunderbird, SeaMonkey<br>
<br>
<span class="label">Fixed in:</span>   Firefox 3.0.9<br>
</p>


<h3>Description</h3>

<p>Mozilla security researcher <strong>moz_bug_r_a4</strong> reported
that it is possible to create a document whose URI does not match the
document's principal using <code>XMLHttpRequest</code>.  This type of
mismatch leads to incorrect results in principal-based security
checks.  An attacker could use this vulnerability to execute arbitrary
JavaScript within the context of another site.</p>

<p>moz_bug_r_a4 separately reported
that <code>XPCNativeWrapper.toString</code>'s
<code>__proto__</code> comes from the wrong scope which results in
calls to that function being executed in the wrong context in certain
circumstances.  An attacker could use this vulnerability to run
arbitrary code within the context of a different site.  Alternatively,
if chrome were to call <code>content.toString.call()</code>, then
attacker-defined functions could be run with chrome privileges.</p>

<p class="note">Thunderbird shares the browser engine with Firefox and
could be vulnerable if JavaScript were to be enabled in mail. This is
not the default setting and we strongly discourage users from running
JavaScript in mail.</p>

<h3>References</h3>

<ul>
  <li><a href="https://bugzilla.mozilla.org/buglist.cgi?bug_id=482206,478433">Same-origin violations</a></li>
  <li><a class="ex-ref" href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1309">CVE-2009-1309</a></li>
</ul>



</div>
<div id="sidebar">
  <?php $left_menu->display(); ?>
  <!-- any other content, promos, etc go here -->
</div>
<?
require_once "{$config['file_root']}/includes/footer-2010.inc.php"
?>
