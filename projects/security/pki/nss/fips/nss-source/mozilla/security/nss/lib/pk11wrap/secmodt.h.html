<?php


$menu = array(
    'id' => 'default',
);

require_once "{$config['file_root']}/includes/header.inc.php"

?>

<pre>
<b><a name="1">    1</a></b> /* ***** BEGIN LICENSE BLOCK *****
<b><a name="2">    2</a></b>  * Version: MPL 1.1/GPL 2.0/LGPL 2.1
<b><a name="3">    3</a></b>  *
<b><a name="4">    4</a></b>  * The contents of this file are subject to the Mozilla Public License Version
<b><a name="5">    5</a></b>  * 1.1 (the "License"); you may not use this file except in compliance with
<b><a name="6">    6</a></b>  * the License. You may obtain a copy of the License at
<b><a name="7">    7</a></b>  * http://www.mozilla.org/MPL/
<b><a name="8">    8</a></b>  *
<b><a name="9">    9</a></b>  * Software distributed under the License is distributed on an "AS IS" basis,
<b><a name="10">   10</a></b>  * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
<b><a name="11">   11</a></b>  * for the specific language governing rights and limitations under the
<b><a name="12">   12</a></b>  * License.
<b><a name="13">   13</a></b>  *
<b><a name="14">   14</a></b>  * The Original Code is the Netscape security libraries.
<b><a name="15">   15</a></b>  *
<b><a name="16">   16</a></b>  * The Initial Developer of the Original Code is
<b><a name="17">   17</a></b>  * Netscape Communications Corporation.
<b><a name="18">   18</a></b>  * Portions created by the Initial Developer are Copyright (C) 1994-2000
<b><a name="19">   19</a></b>  * the Initial Developer. All Rights Reserved.
<b><a name="20">   20</a></b>  *
<b><a name="21">   21</a></b>  * Contributor(s):
<b><a name="22">   22</a></b>  *
<b><a name="23">   23</a></b>  * Alternatively, the contents of this file may be used under the terms of
<b><a name="24">   24</a></b>  * either the GNU General Public License Version 2 or later (the "GPL"), or
<b><a name="25">   25</a></b>  * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
<b><a name="26">   26</a></b>  * in which case the provisions of the GPL or the LGPL are applicable instead
<b><a name="27">   27</a></b>  * of those above. If you wish to allow use of your version of this file only
<b><a name="28">   28</a></b>  * under the terms of either the GPL or the LGPL, and not to allow others to
<b><a name="29">   29</a></b>  * use your version of this file under the terms of the MPL, indicate your
<b><a name="30">   30</a></b>  * decision by deleting the provisions above and replace them with the notice
<b><a name="31">   31</a></b>  * and other provisions required by the GPL or the LGPL. If you do not delete
<b><a name="32">   32</a></b>  * the provisions above, a recipient may use your version of this file under
<b><a name="33">   33</a></b>  * the terms of any one of the MPL, the GPL or the LGPL.
<b><a name="34">   34</a></b>  *
<b><a name="35">   35</a></b>  * ***** END LICENSE BLOCK ***** */
<b><a name="36">   36</a></b> #ifndef <a href="../pk11wrap/secmodt.h.dep.html#_SECMODT_H_">_SECMODT_H_</a>
<b><a name="37">   37</a></b> #define <a href="#37">_SECMODT_H_</a> 1
<b><a name="38">   38</a></b> 
<b><a name="39">   39</a></b> #include "nssrwlkt.h"
<b><a name="40">   40</a></b> #include "nssilckt.h"
<b><a name="41">   41</a></b> #include "secoid.h"
<b><a name="42">   42</a></b> #include "secasn1.h"
<b><a name="43">   43</a></b> #include "pkcs11t.h"
<b><a name="44">   44</a></b> 
<b><a name="45">   45</a></b> /* find a better home for these... */
<b><a name="46">   46</a></b> extern const <a href="../util/secasn1t.h.dep.html#SEC_ASN1Template">SEC_ASN1Template</a> <a href="#46">SECKEY_PointerToEncryptedPrivateKeyInfoTemplate</a>[];
<b><a name="47">   47</a></b> extern <a href="../util/secasn1t.h.dep.html#SEC_ASN1TemplateChooser">SEC_ASN1TemplateChooser</a> <a href="#47">NSS_Get_SECKEY_PointerToEncryptedPrivateKeyInfoTemplate</a>;
<b><a name="48">   48</a></b> extern const <a href="../util/secasn1t.h.dep.html#SEC_ASN1Template">SEC_ASN1Template</a> <a href="#48">SECKEY_EncryptedPrivateKeyInfoTemplate</a>[];
<b><a name="49">   49</a></b> extern <a href="../util/secasn1t.h.dep.html#SEC_ASN1TemplateChooser">SEC_ASN1TemplateChooser</a> <a href="#49">NSS_Get_SECKEY_EncryptedPrivateKeyInfoTemplate</a>;
<b><a name="50">   50</a></b> extern const <a href="../util/secasn1t.h.dep.html#SEC_ASN1Template">SEC_ASN1Template</a> <a href="#50">SECKEY_PrivateKeyInfoTemplate</a>[];
<b><a name="51">   51</a></b> extern <a href="../util/secasn1t.h.dep.html#SEC_ASN1TemplateChooser">SEC_ASN1TemplateChooser</a> <a href="#51">NSS_Get_SECKEY_PrivateKeyInfoTemplate</a>;
<b><a name="52">   52</a></b> extern const <a href="../util/secasn1t.h.dep.html#SEC_ASN1Template">SEC_ASN1Template</a> <a href="#52">SECKEY_PointerToPrivateKeyInfoTemplate</a>[];
<b><a name="53">   53</a></b> extern <a href="../util/secasn1t.h.dep.html#SEC_ASN1TemplateChooser">SEC_ASN1TemplateChooser</a> <a href="#53">NSS_Get_SECKEY_PointerToPrivateKeyInfoTemplate</a>;
<b><a name="54">   54</a></b> 
<b><a name="55">   55</a></b> /* PKCS11 needs to be included */
<b><a name="56">   56</a></b> typedef struct <a href="../pk11wrap/secmodt.h.dep.html#<a href="#56">SECMODModule</a>Str">SECMODModuleStr</a> SECMODModule;
<b><a name="57">   57</a></b> typedef struct <a href="#57">SECMODModuleList</a>Str SECMODModuleList;
<b><a name="58">   58</a></b> typedef <a href="../util/nssrwlkt.h.dep.html#NSSRWLock">NSSRWLock</a> <a href="#58">SECMODListLock</a>;
<b><a name="59">   59</a></b> typedef struct <a href="../pk11wrap/secmodti.h.dep.html#<a href="#59">PK11SlotInfo</a>Str">PK11SlotInfoStr</a> PK11SlotInfo; /* defined in secmodti.h */
<b><a name="60">   60</a></b> typedef struct <a href="#60">PK11PreSlotInfo</a>Str PK11PreSlotInfo; /* defined in secmodti.h */
<b><a name="61">   61</a></b> typedef struct <a href="#61">PK11SymKey</a>Str PK11SymKey; /* defined in secmodti.h */
<b><a name="62">   62</a></b> typedef struct <a href="#62">PK11Context</a>Str PK11Context; /* defined in secmodti.h */
<b><a name="63">   63</a></b> typedef struct <a href="../pk11wrap/secmodt.h.dep.html#<a href="#63">PK11SlotList</a>Str">PK11SlotListStr</a> PK11SlotList;
<b><a name="64">   64</a></b> typedef struct <a href="../pk11wrap/secmodt.h.dep.html#<a href="#64">PK11SlotListElement</a>Str">PK11SlotListElementStr</a> PK11SlotListElement;
<b><a name="65">   65</a></b> typedef struct <a href="../pk11wrap/secmodt.h.dep.html#<a href="#65">PK11RSAGenParams</a>Str">PK11RSAGenParamsStr</a> PK11RSAGenParams;
<b><a name="66">   66</a></b> typedef unsigned long <a href="#66">SECMODModuleID</a>;
<b><a name="67">   67</a></b> typedef struct <a href="../pk11wrap/secmodt.h.dep.html#<a href="#67">PK11DefaultArrayEntry</a>Str">PK11DefaultArrayEntryStr</a> PK11DefaultArrayEntry;
<b><a name="68">   68</a></b> typedef struct <a href="../pk11wrap/secmodti.h.dep.html#<a href="#68">PK11GenericObject</a>Str">PK11GenericObjectStr</a> PK11GenericObject;
<b><a name="69">   69</a></b> typedef void (*<a href="#69">PK11FreeDataFunc</a>)(void *);
<b><a name="70">   70</a></b> 
<b><a name="71">   71</a></b> struct <a href="#71">SECMODModuleStr</a> {
<b><a name="72">   72</a></b>     <a href="../mozilla/nsprpub/pr/include/obsolete/protypes.h.dep.html#PRArenaPool">PRArenaPool</a>        *arena;
<b><a name="73">   73</a></b>     <a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PRBool">PRBool</a>        internal;        /* true of internally linked modules, false
<b><a name="74">   74</a></b>                                  * for the loaded modules */
<b><a name="75">   75</a></b>     <a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PRBool">PRBool</a>        loaded;                /* Set to true if module has been loaded */
<b><a name="76">   76</a></b>     <a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PRBool">PRBool</a>        isFIPS;                /* Set to true if module is finst internal */
<b><a name="77">   77</a></b>     char        *<a href="../softoken/pk11pars.h.dep.html#dllName">dllName</a>;        /* name of the shared library which implements
<b><a name="78">   78</a></b>                                  * this module */
<b><a name="79">   79</a></b>     char        *<a href="../softoken/pk11pars.h.dep.html#commonName">commonName</a>;        /* name of the module to display to the user */
<b><a name="80">   80</a></b>     void        *library;        /* pointer to the library. opaque. used only by
<b><a name="81">   81</a></b>                                  * pk11load.c */
<b><a name="82">   82</a></b>     void        *functionList; /* The PKCS #11 function table */
<b><a name="83">   83</a></b>     <a href="../util/nssilckt.h.dep.html#PZLock">PZLock</a></a>        *refLock;        /* only used pk11db.c */
<b><a name="84">   84</a></b>     int                refCount;        /* Module reference count */
<b><a name="85">   85</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#PK11SlotInfo">PK11SlotInfo</a> **slots;        /* array of slot points attached to this mod*/
<b><a name="86">   86</a></b>     int                <a href="../softoken/pk11pars.h.dep.html#slotCount">slotCount</a></a>;        /* count of slot in above array */
<b><a name="87">   87</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#PK11PreSlotInfo">PK11PreSlotInfo</a> *slotInfo;        /* special info about slots default settings */
<b><a name="88">   88</a></b>     int                slotInfoCount;  /* count */
<b><a name="89">   89</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#SECMODModuleID">SECMODModuleID</a> moduleID;        /* ID so we can find this module again */
<b><a name="90">   90</a></b>     <a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PRBool">PRBool</a>        isThreadSafe;
<b><a name="91">   91</a></b>     unsigned long ssl[2];        /* SSL cipher enable flags */
<b><a name="92">   92</a></b>     char        *libraryParams;  /* Module specific parameters */
<b><a name="93">   93</a></b>     void *moduleDBFunc; /* function to return module configuration data*/
<b><a name="94">   94</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#SECMODModule">SECMODModule</a> *parent;        /* module that loaded us */
<b><a name="95">   95</a></b>     <a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PRBool">PRBool</a>        isCritical;        /* This module must load successfully */
<b><a name="96">   96</a></b>     <a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PRBool">PRBool</a>        isModuleDB;        /* this module has lists of PKCS #11 modules */
<b><a name="97">   97</a></b>     <a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PRBool">PRBool</a>        moduleDBOnly;        /* this module only has lists of PKCS #11 modules */
<b><a name="98">   98</a></b>     int                trustOrder;        /* order for this module's certificate trust rollup */
<b><a name="99">   99</a></b>     int                cipherOrder;        /* order for cipher operations */
<b><a name="100">  100</a></b>     unsigned long evControlMask; /* control the running and shutdown of slot
<b><a name="101">  101</a></b>                                   * events (SECMOD_WaitForAnyTokenEvent) */
<b><a name="102">  102</a></b>     <a href="../softoken/pkcs11t.h.dep.html#CK_VERSION">CK_VERSION</a></a>  cryptokiVersion; /* version of this library */
<b><a name="103">  103</a></b> };
<b><a name="104">  104</a></b> 
<b><a name="105">  105</a></b> /* evControlMask flags */
<b><a name="106">  106</a></b> /*
<b><a name="107">  107</a></b>  * These bits tell the current state of a SECMOD_WaitForAnyTokenEvent.
<b><a name="108">  108</a></b>  *
<b><a name="109">  109</a></b>  * SECMOD_WAIT_PKCS11_EVENT - we're waiting in the PKCS #11 module in
<b><a name="110">  110</a></b>  *  C_WaitForSlotEvent().
<b><a name="111">  111</a></b>  * SECMOD_WAIT_SIMULATED_EVENT - we're waiting in the NSS simulation code
<b><a name="112">  112</a></b>  *  which polls for token insertion and removal events.
<b><a name="113">  113</a></b>  * SECMOD_END_WAIT - SECMOD_CancelWait has been called while the module is
<b><a name="114">  114</a></b>  *  waiting in SECMOD_WaitForAnyTokenEvent. SECMOD_WaitForAnyTokenEvent
<b><a name="115">  115</a></b>  *  should return immediately to it's caller.
<b><a name="116">  116</a></b>  */ 
<b><a name="117">  117</a></b> #define <a href="#117">SECMOD_END_WAIT</a>             0x01
<b><a name="118">  118</a></b> #define <a href="#118">SECMOD_WAIT_SIMULATED_EVENT</a> 0x02 
<b><a name="119">  119</a></b> #define <a href="#119">SECMOD_WAIT_PKCS11_EVENT</a>    0x04
<b><a name="120">  120</a></b> 
<b><a name="121">  121</a></b> struct <a href="#121">SECMODModuleListStr</a> {
<b><a name="122">  122</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#SECMODModuleList">SECMODModuleList</a>        *<a href="../mozilla/nsprpub/pr/src/misc/prtrace.c.dep.html#next">next</a>;
<b><a name="123">  123</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#SECMODModule">SECMODModule</a>        *module;
<b><a name="124">  124</a></b> };
<b><a name="125">  125</a></b> 
<b><a name="126">  126</a></b> struct <a href="#126">PK11SlotListStr</a> {
<b><a name="127">  127</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#PK11SlotListElement">PK11SlotListElement</a> *<a href="../mozilla/security/nss/cmd/zlib/deflate.c.dep.html#head">head</a><a href="../mozilla/security/nss/cmd/zlib/inflate.c.dep.html#head"><sup>[1]</sup></a>;
<b><a name="128">  128</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#PK11SlotListElement">PK11SlotListElement</a> *tail;
<b><a name="129">  129</a></b>     <a href="../util/nssilckt.h.dep.html#PZLock">PZLock</a></a> *<a href="../mozilla/nsprpub/pr/tests/intrio.c.dep.html#lock">lock</a><a href="../mozilla/nsprpub/pr/tests/perf.c.dep.html#lock"><sup>[1]</sup></a><a href="../mozilla/nsprpub/pr/tests/testfile.c.dep.html#lock"><sup>[2]</sup></a>;
<b><a name="130">  130</a></b> };
<b><a name="131">  131</a></b> 
<b><a name="132">  132</a></b> struct <a href="#132">PK11SlotListElementStr</a> {
<b><a name="133">  133</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#PK11SlotListElement">PK11SlotListElement</a> *<a href="../mozilla/nsprpub/pr/src/misc/prtrace.c.dep.html#next">next</a>;
<b><a name="134">  134</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#PK11SlotListElement">PK11SlotListElement</a> *prev;
<b><a name="135">  135</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#PK11SlotInfo">PK11SlotInfo</a> *<a href="../mozilla/security/nss/tests/pkcs11/netscape/suites/security/pkcs11/pk11test.c.dep.html#slot">slot</a>;
<b><a name="136">  136</a></b>     int refCount;
<b><a name="137">  137</a></b> };
<b><a name="138">  138</a></b> 
<b><a name="139">  139</a></b> struct <a href="#139">PK11RSAGenParamsStr</a> {
<b><a name="140">  140</a></b>     int keySizeInBits;
<b><a name="141">  141</a></b>     unsigned long pe;
<b><a name="142">  142</a></b> };
<b><a name="143">  143</a></b> 
<b><a name="144">  144</a></b> typedef enum {
<b><a name="145">  145</a></b>      PK11CertListUnique = 0,     /* get one instance of all certs */
<b><a name="146">  146</a></b>      PK11CertListUser = 1,       /* get all instances of user certs */
<b><a name="147">  147</a></b>      PK11CertListRootUnique = 2, /* get one instance of CA certs without a private key.
<b><a name="148">  148</a></b>                                   * deprecated. Use PK11CertListCAUnique
<b><a name="149">  149</a></b>                                   */
<b><a name="150">  150</a></b>      PK11CertListCA = 3,         /* get all instances of CA certs */
<b><a name="151">  151</a></b>      PK11CertListCAUnique = 4,   /* get one instance of CA certs */
<b><a name="152">  152</a></b>      PK11CertListUserUnique = 5, /* get one instance of user certs */
<b><a name="153">  153</a></b>      PK11CertListAll = 6         /* get all instances of all certs */
<b><a name="154">  154</a></b> } <a href="#154">PK11CertListType</a>;
<b><a name="155">  155</a></b> 
<b><a name="156">  156</a></b> /*
<b><a name="157">  157</a></b>  * Entry into the Array which lists all the legal bits for the default flags
<b><a name="158">  158</a></b>  * in the slot, their definition, and the PKCS #11 mechanism the represent
<b><a name="159">  159</a></b>  * Always Statically allocated. 
<b><a name="160">  160</a></b>  */
<b><a name="161">  161</a></b> struct <a href="#161">PK11DefaultArrayEntryStr</a> {
<b><a name="162">  162</a></b>     char *name;
<b><a name="163">  163</a></b>     unsigned long flag;
<b><a name="164">  164</a></b>     unsigned long <a href="../mozilla/security/nss/tests/pkcs11/netscape/suites/security/pkcs11/pk11test.h.dep.html#mechanism">mechanism</a>; /* this is a long so we don't include the 
<b><a name="165">  165</a></b>                               * whole pkcs 11 world to use this header */
<b><a name="166">  166</a></b> };
<b><a name="167">  167</a></b> 
<b><a name="168">  168</a></b> 
<b><a name="169">  169</a></b> #define <a href="#169">SECMOD_RSA_FLAG</a>         0x00000001L
<b><a name="170">  170</a></b> #define <a href="#170">SECMOD_DSA_FLAG</a>         0x00000002L
<b><a name="171">  171</a></b> #define <a href="#171">SECMOD_RC2_FLAG</a>         0x00000004L
<b><a name="172">  172</a></b> #define <a href="#172">SECMOD_RC4_FLAG</a>         0x00000008L
<b><a name="173">  173</a></b> #define <a href="#173">SECMOD_DES_FLAG</a>         0x00000010L
<b><a name="174">  174</a></b> #define <a href="#174">SECMOD_DH_FLAG</a>                 0x00000020L
<b><a name="175">  175</a></b> #define <a href="#175">SECMOD_FORTEZZA_FLAG</a>        0x00000040L
<b><a name="176">  176</a></b> #define <a href="#176">SECMOD_RC5_FLAG</a>                0x00000080L
<b><a name="177">  177</a></b> #define <a href="#177">SECMOD_SHA1_FLAG</a>        0x00000100L
<b><a name="178">  178</a></b> #define <a href="#178">SECMOD_MD5_FLAG</a>                0x00000200L
<b><a name="179">  179</a></b> #define <a href="#179">SECMOD_MD2_FLAG</a>                0x00000400L
<b><a name="180">  180</a></b> #define <a href="#180">SECMOD_SSL_FLAG</a>                0x00000800L
<b><a name="181">  181</a></b> #define <a href="#181">SECMOD_TLS_FLAG</a>                0x00001000L
<b><a name="182">  182</a></b> #define <a href="#182">SECMOD_AES_FLAG</a>         0x00002000L
<b><a name="183">  183</a></b> #define <a href="#183">SECMOD_SHA256_FLAG</a>        0x00004000L
<b><a name="184">  184</a></b> #define <a href="#184">SECMOD_SHA512_FLAG</a>        0x00008000L        /* also for SHA384 */
<b><a name="185">  185</a></b> /* reserved bit for future, do not use */
<b><a name="186">  186</a></b> #define <a href="#186">SECMOD_RESERVED_FLAG</a>    0X08000000L
<b><a name="187">  187</a></b> #define <a href="#187">SECMOD_FRIENDLY_FLAG</a>        0x10000000L
<b><a name="188">  188</a></b> #define <a href="#188">SECMOD_RANDOM_FLAG</a>        0x80000000L
<b><a name="189">  189</a></b> 
<b><a name="190">  190</a></b> /* need to make SECMOD and PK11 prefixes consistant. */
<b><a name="191">  191</a></b> #define <a href="#191">PK11_OWN_PW_DEFAULTS</a> 0x20000000L
<b><a name="192">  192</a></b> #define <a href="#192">PK11_DISABLE_FLAG</a>    0x40000000L
<b><a name="193">  193</a></b> 
<b><a name="194">  194</a></b> /* FAKE PKCS #11 defines */
<b><a name="195">  195</a></b> #define <a href="#195">CKM_FAKE_RANDOM</a>       0x80000efeL
<b><a name="196">  196</a></b> #define <a href="#196">CKM_INVALID_MECHANISM</a> 0xffffffffL
<b><a name="197">  197</a></b> #define <a href="#197">CKA_DIGEST</a>            0x81000000L
<b><a name="198">  198</a></b> #define <a href="#198">CKA_FLAGS_ONLY</a>        0 /* CKA_CLASS */
<b><a name="199">  199</a></b> 
<b><a name="200">  200</a></b> /*
<b><a name="201">  201</a></b>  * PK11AttrFlags
<b><a name="202">  202</a></b>  *
<b><a name="203">  203</a></b>  * A 32-bit bitmask of PK11_ATTR_XXX flags
<b><a name="204">  204</a></b>  */
<b><a name="205">  205</a></b> typedef <a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PRUint32">PRUint32</a></a> <a href="#205">PK11AttrFlags</a>;
<b><a name="206">  206</a></b> 
<b><a name="207">  207</a></b> /*
<b><a name="208">  208</a></b>  * PK11_ATTR_XXX
<b><a name="209">  209</a></b>  *
<b><a name="210">  210</a></b>  * The following PK11_ATTR_XXX bitflags are used to specify
<b><a name="211">  211</a></b>  * PKCS #11 object attributes that have Boolean values.  Some NSS
<b><a name="212">  212</a></b>  * functions have a "PK11AttrFlags attrFlags" parameter whose value
<b><a name="213">  213</a></b>  * is the logical OR of these bitflags.  NSS use these bitflags on
<b><a name="214">  214</a></b>  * private keys or secret keys.  Some of these bitflags also apply
<b><a name="215">  215</a></b>  * to the public keys associated with the private keys.
<b><a name="216">  216</a></b>  *
<b><a name="217">  217</a></b>  * For each PKCS #11 object attribute, we need two bitflags to
<b><a name="218">  218</a></b>  * specify not only "true" and "false" but also "default".  For
<b><a name="219">  219</a></b>  * example, PK11_ATTR_PRIVATE and PK11_ATTR_PUBLIC control the
<b><a name="220">  220</a></b>  * CKA_PRIVATE attribute.  If PK11_ATTR_PRIVATE is set, we add
<b><a name="221">  221</a></b>  *     { CKA_PRIVATE, &amp;cktrue, sizeof(CK_BBOOL) }
<b><a name="222">  222</a></b>  * to the template.  If PK11_ATTR_PUBLIC is set, we add
<b><a name="223">  223</a></b>  *     { CKA_PRIVATE, &amp;ckfalse, sizeof(CK_BBOOL) }
<b><a name="224">  224</a></b>  * to the template.  If neither flag is set, we don't add any
<b><a name="225">  225</a></b>  * CKA_PRIVATE entry to the template.
<b><a name="226">  226</a></b>  */
<b><a name="227">  227</a></b> 
<b><a name="228">  228</a></b> /*
<b><a name="229">  229</a></b>  * Attributes for PKCS #11 storage objects, which include not only
<b><a name="230">  230</a></b>  * keys but also certificates and domain parameters.
<b><a name="231">  231</a></b>  */
<b><a name="232">  232</a></b> 
<b><a name="233">  233</a></b> /*
<b><a name="234">  234</a></b>  * PK11_ATTR_TOKEN
<b><a name="235">  235</a></b>  * PK11_ATTR_SESSION
<b><a name="236">  236</a></b>  *
<b><a name="237">  237</a></b>  * These two flags determine whether the object is a token or
<b><a name="238">  238</a></b>  * session object.
<b><a name="239">  239</a></b>  *
<b><a name="240">  240</a></b>  * These two flags are related and cannot both be set.
<b><a name="241">  241</a></b>  * If the PK11_ATTR_TOKEN flag is set, the object is a token
<b><a name="242">  242</a></b>  * object.  If the PK11_ATTR_SESSION flag is set, the object is
<b><a name="243">  243</a></b>  * a session object.  If neither flag is set, the object is *by
<b><a name="244">  244</a></b>  * default* a session object.
<b><a name="245">  245</a></b>  *
<b><a name="246">  246</a></b>  * These two flags specify the value of the PKCS #11 CKA_TOKEN
<b><a name="247">  247</a></b>  * attribute.
<b><a name="248">  248</a></b>  */
<b><a name="249">  249</a></b> #define <a href="#249">PK11_ATTR_TOKEN</a>         0x00000001L
<b><a name="250">  250</a></b> #define <a href="#250">PK11_ATTR_SESSION</a>       0x00000002L
<b><a name="251">  251</a></b> 
<b><a name="252">  252</a></b> /*
<b><a name="253">  253</a></b>  * PK11_ATTR_PRIVATE
<b><a name="254">  254</a></b>  * PK11_ATTR_PUBLIC
<b><a name="255">  255</a></b>  *
<b><a name="256">  256</a></b>  * These two flags determine whether the object is a private or
<b><a name="257">  257</a></b>  * public object.  A user may not access a private object until the
<b><a name="258">  258</a></b>  * user has authenticated to the token.
<b><a name="259">  259</a></b>  *
<b><a name="260">  260</a></b>  * These two flags are related and cannot both be set.
<b><a name="261">  261</a></b>  * If the PK11_ATTR_PRIVATE flag is set, the object is a private
<b><a name="262">  262</a></b>  * object.  If the PK11_ATTR_PUBLIC flag is set, the object is a
<b><a name="263">  263</a></b>  * public object.  If neither flag is set, it is token-specific
<b><a name="264">  264</a></b>  * whether the object is private or public.
<b><a name="265">  265</a></b>  *
<b><a name="266">  266</a></b>  * These two flags specify the value of the PKCS #11 CKA_PRIVATE
<b><a name="267">  267</a></b>  * attribute.  NSS only uses this attribute on private and secret
<b><a name="268">  268</a></b>  * keys, so public keys created by NSS get the token-specific
<b><a name="269">  269</a></b>  * default value of the CKA_PRIVATE attribute.
<b><a name="270">  270</a></b>  */
<b><a name="271">  271</a></b> #define <a href="#271">PK11_ATTR_PRIVATE</a>       0x00000004L
<b><a name="272">  272</a></b> #define <a href="#272">PK11_ATTR_PUBLIC</a>        0x00000008L
<b><a name="273">  273</a></b> 
<b><a name="274">  274</a></b> /*
<b><a name="275">  275</a></b>  * PK11_ATTR_MODIFIABLE
<b><a name="276">  276</a></b>  * PK11_ATTR_UNMODIFIABLE
<b><a name="277">  277</a></b>  *
<b><a name="278">  278</a></b>  * These two flags determine whether the object is modifiable or
<b><a name="279">  279</a></b>  * read-only.
<b><a name="280">  280</a></b>  *
<b><a name="281">  281</a></b>  * These two flags are related and cannot both be set.
<b><a name="282">  282</a></b>  * If the PK11_ATTR_MODIFIABLE flag is set, the object can be
<b><a name="283">  283</a></b>  * modified.  If the PK11_ATTR_UNMODIFIABLE flag is set, the object
<b><a name="284">  284</a></b>  * is read-only.  If neither flag is set, the object is *by default*
<b><a name="285">  285</a></b>  * modifiable.
<b><a name="286">  286</a></b>  *
<b><a name="287">  287</a></b>  * These two flags specify the value of the PKCS #11 CKA_MODIFIABLE
<b><a name="288">  288</a></b>  * attribute.
<b><a name="289">  289</a></b>  */
<b><a name="290">  290</a></b> #define <a href="#290">PK11_ATTR_MODIFIABLE</a>    0x00000010L
<b><a name="291">  291</a></b> #define <a href="#291">PK11_ATTR_UNMODIFIABLE</a>  0x00000020L
<b><a name="292">  292</a></b> 
<b><a name="293">  293</a></b> /* Attributes for PKCS #11 key objects. */
<b><a name="294">  294</a></b> 
<b><a name="295">  295</a></b> /*
<b><a name="296">  296</a></b>  * PK11_ATTR_SENSITIVE
<b><a name="297">  297</a></b>  * PK11_ATTR_INSENSITIVE
<b><a name="298">  298</a></b>  *
<b><a name="299">  299</a></b>  * These two flags are related and cannot both be set.
<b><a name="300">  300</a></b>  * If the PK11_ATTR_SENSITIVE flag is set, the key is sensitive.
<b><a name="301">  301</a></b>  * If the PK11_ATTR_INSENSITIVE flag is set, the key is not
<b><a name="302">  302</a></b>  * sensitive.  If neither flag is set, it is token-specific whether
<b><a name="303">  303</a></b>  * the key is sensitive or not.
<b><a name="304">  304</a></b>  *
<b><a name="305">  305</a></b>  * If a key is sensitive, certain attributes of the key cannot be
<b><a name="306">  306</a></b>  * revealed in plaintext outside the token.
<b><a name="307">  307</a></b>  *
<b><a name="308">  308</a></b>  * This flag specifies the value of the PKCS #11 CKA_SENSITIVE
<b><a name="309">  309</a></b>  * attribute.  Although the default value of the CKA_SENSITIVE
<b><a name="310">  310</a></b>  * attribute for secret keys is CK_FALSE per PKCS #11, some FIPS
<b><a name="311">  311</a></b>  * tokens set the default value to CK_TRUE because only CK_TRUE
<b><a name="312">  312</a></b>  * is allowed.  So in practice the default value of this attribute
<b><a name="313">  313</a></b>  * is token-specific, hence the need for two bitflags.
<b><a name="314">  314</a></b>  */
<b><a name="315">  315</a></b> #define <a href="#315">PK11_ATTR_SENSITIVE</a>     0x00000040L
<b><a name="316">  316</a></b> #define <a href="#316">PK11_ATTR_INSENSITIVE</a>   0x00000080L
<b><a name="317">  317</a></b> 
<b><a name="318">  318</a></b> /*
<b><a name="319">  319</a></b>  * PK11_ATTR_EXTRACTABLE
<b><a name="320">  320</a></b>  * PK11_ATTR_UNEXTRACTABLE
<b><a name="321">  321</a></b>  *
<b><a name="322">  322</a></b>  * These two flags are related and cannot both be set.
<b><a name="323">  323</a></b>  * If the PK11_ATTR_EXTRACTABLE flag is set, the key is extractable
<b><a name="324">  324</a></b>  * and can be wrapped.  If the PK11_ATTR_UNEXTRACTABLE flag is set,
<b><a name="325">  325</a></b>  * the key is not extractable, and certain attributes of the key
<b><a name="326">  326</a></b>  * cannot be revealed in plaintext outside the token (just like a
<b><a name="327">  327</a></b>  * sensitive key).  If neither flag is set, it is token-specific
<b><a name="328">  328</a></b>  * whether the key is extractable or not.
<b><a name="329">  329</a></b>  *
<b><a name="330">  330</a></b>  * These two flags specify the value of the PKCS #11 CKA_EXTRACTABLE
<b><a name="331">  331</a></b>  * attribute.
<b><a name="332">  332</a></b>  */
<b><a name="333">  333</a></b> #define <a href="#333">PK11_ATTR_EXTRACTABLE</a>   0x00000100L
<b><a name="334">  334</a></b> #define <a href="#334">PK11_ATTR_UNEXTRACTABLE</a> 0x00000200L
<b><a name="335">  335</a></b> 
<b><a name="336">  336</a></b> /* Cryptographic module types */
<b><a name="337">  337</a></b> #define <a href="#337">SECMOD_EXTERNAL</a>        0        /* external module */
<b><a name="338">  338</a></b> #define <a href="#338">SECMOD_INTERNAL</a> 1        /* internal default module */
<b><a name="339">  339</a></b> #define <a href="#339">SECMOD_FIPS</a>        2        /* internal fips module */
<b><a name="340">  340</a></b> 
<b><a name="341">  341</a></b> /* default module configuration strings */
<b><a name="342">  342</a></b> #define <a href="#342">SECMOD_SLOT_FLAGS</a> "slotFlags=[RSA,DSA,DH,RC2,RC4,DES,<a href="../freebl/mpi/mpprime.c.dep.html#RANDOM">RANDOM</a>,SHA1,MD5,MD2,SSL,TLS,<a href="../util/secoid.c.dep.html#AES">AES</a>,SHA256,SHA512]"
<b><a name="343">  343</a></b> 
<b><a name="344">  344</a></b> #define <a href="#344">SECMOD_MAKE_NSS_FLAGS</a>(fips,<a href="../mozilla/security/nss/tests/pkcs11/netscape/suites/security/pkcs11/pk11test.c.dep.html#slot">slot</a>) \
<b><a name="345">  345</a></b> "Flags=internal,critical"fips" slotparams=("#slot"={"<a href="../pk11wrap/secmodt.h.dep.html#SECMOD_SLOT_FLAGS">SECMOD_SLOT_FLAGS</a>"})"
<b><a name="346">  346</a></b> 
<b><a name="347">  347</a></b> #define <a href="#347">SECMOD_INT_NAME</a> "<a href="../softoken/pk11pars.h.dep.html#NSS">NSS</a> Internal <a href="../util/secoid.c.dep.html#PKCS">PKCS</a> #11 <a href="../mozilla/security/nss/cmd/pk11util/pk11util.h.dep.html#Module">Module</a>"
<b><a name="348">  348</a></b> #define <a href="#348">SECMOD_INT_FLAGS</a> <a href="../pk11wrap/secmodt.h.dep.html#SECMOD_MAKE_NSS_FLAGS">SECMOD_MAKE_NSS_FLAGS</a>("",1)
<b><a name="349">  349</a></b> #define <a href="#349">SECMOD_FIPS_NAME</a> "<a href="../softoken/pk11pars.h.dep.html#NSS">NSS</a> Internal FIPS <a href="../util/secoid.c.dep.html#PKCS">PKCS</a> #11 <a href="../mozilla/security/nss/cmd/pk11util/pk11util.h.dep.html#Module">Module</a>"
<b><a name="350">  350</a></b> #define <a href="#350">SECMOD_FIPS_FLAGS</a> <a href="../pk11wrap/secmodt.h.dep.html#SECMOD_MAKE_NSS_FLAGS">SECMOD_MAKE_NSS_FLAGS</a>(",fips",3)
<b><a name="351">  351</a></b> 
<b><a name="352">  352</a></b> /*
<b><a name="353">  353</a></b>  * What is the origin of a given Key. Normally this doesn't matter, but
<b><a name="354">  354</a></b>  * the fortezza code needs to know if it needs to invoke the SSL3 fortezza
<b><a name="355">  355</a></b>  * hack.
<b><a name="356">  356</a></b>  */
<b><a name="357">  357</a></b> typedef enum {
<b><a name="358">  358</a></b>     PK11_OriginNULL = 0,        /* There is not key, it's a null SymKey */
<b><a name="359">  359</a></b>     PK11_OriginDerive = 1,        /* Key was derived from some other key */
<b><a name="360">  360</a></b>     PK11_OriginGenerated = 2,        /* Key was generated (also PBE keys) */
<b><a name="361">  361</a></b>     PK11_OriginFortezzaHack = 3,/* Key was marked for fortezza hack */
<b><a name="362">  362</a></b>     PK11_OriginUnwrap = 4        /* Key was unwrapped or decrypted */
<b><a name="363">  363</a></b> } <a href="#363">PK11Origin</a>;
<b><a name="364">  364</a></b> 
<b><a name="365">  365</a></b> /* PKCS #11 disable reasons */
<b><a name="366">  366</a></b> typedef enum {
<b><a name="367">  367</a></b>     PK11_DIS_NONE = 0,
<b><a name="368">  368</a></b>     PK11_DIS_USER_SELECTED = 1,
<b><a name="369">  369</a></b>     PK11_DIS_COULD_NOT_INIT_TOKEN = 2,
<b><a name="370">  370</a></b>     PK11_DIS_TOKEN_VERIFY_FAILED = 3,
<b><a name="371">  371</a></b>     PK11_DIS_TOKEN_NOT_PRESENT = 4
<b><a name="372">  372</a></b> } <a href="#372">PK11DisableReasons</a>;
<b><a name="373">  373</a></b> 
<b><a name="374">  374</a></b> /* types of PKCS #11 objects */
<b><a name="375">  375</a></b> typedef enum {
<b><a name="376">  376</a></b>    PK11_TypeGeneric = 0,
<b><a name="377">  377</a></b>    PK11_TypePrivKey = 1,
<b><a name="378">  378</a></b>    PK11_TypePubKey = 2,
<b><a name="379">  379</a></b>    PK11_TypeCert = 3,
<b><a name="380">  380</a></b>    PK11_TypeSymKey = 4
<b><a name="381">  381</a></b> } <a href="#381">PK11ObjectType</a>;
<b><a name="382">  382</a></b> 
<b><a name="383">  383</a></b> 
<b><a name="384">  384</a></b> 
<b><a name="385">  385</a></b> /* function pointer type for password callback function.
<b><a name="386">  386</a></b>  * This type is passed in to PK11_SetPasswordFunc() 
<b><a name="387">  387</a></b>  */
<b><a name="388">  388</a></b> typedef char *(<a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PR_CALLBACK">PR_CALLBACK</a></a></a></a></a></a></a> *<a href="#388">PK11PasswordFunc</a>)(<a href="../pk11wrap/secmodt.h.dep.html#PK11SlotInfo">PK11SlotInfo</a> *<a href="../mozilla/security/nss/tests/pkcs11/netscape/suites/security/pkcs11/pk11test.c.dep.html#slot">slot</a>, <a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PRBool">PRBool</a> retry, void *arg);
<b><a name="389">  389</a></b> typedef <a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PRBool">PRBool</a> (<a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PR_CALLBACK">PR_CALLBACK</a></a></a></a></a></a></a> *<a href="#389">PK11VerifyPasswordFunc</a>)(<a href="../pk11wrap/secmodt.h.dep.html#PK11SlotInfo">PK11SlotInfo</a> *<a href="../mozilla/security/nss/tests/pkcs11/netscape/suites/security/pkcs11/pk11test.c.dep.html#slot">slot</a>, void *arg);
<b><a name="390">  390</a></b> typedef <a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PRBool">PRBool</a> (<a href="../mozilla/nsprpub/pr/include/prtypes.h.dep.html#PR_CALLBACK">PR_CALLBACK</a></a></a></a></a></a></a> *<a href="#390">PK11IsLoggedInFunc</a>)(<a href="../pk11wrap/secmodt.h.dep.html#PK11SlotInfo">PK11SlotInfo</a> *<a href="../mozilla/security/nss/tests/pkcs11/netscape/suites/security/pkcs11/pk11test.c.dep.html#slot">slot</a>, void *arg);
<b><a name="391">  391</a></b> 
<b><a name="392">  392</a></b> /*
<b><a name="393">  393</a></b>  * Special strings the password callback function can return only if
<b><a name="394">  394</a></b>  * the slot is an protected auth path slot.
<b><a name="395">  395</a></b>  */ 
<b><a name="396">  396</a></b> #define <a href="#396">PK11_PW_RETRY</a>                "RETRY"        /* an failed attempt to authenticate
<b><a name="397">  397</a></b>                                          * has already been made, just retry
<b><a name="398">  398</a></b>                                          * the operation */
<b><a name="399">  399</a></b> #define <a href="#399">PK11_PW_AUTHENTICATED</a>        "AUTH"  /* a successful attempt to authenticate
<b><a name="400">  400</a></b>                                          * has completed. Continue without
<b><a name="401">  401</a></b>                                          * another call to C_Login */
<b><a name="402">  402</a></b> /* All other non-null values mean that that NSS could call C_Login to force
<b><a name="403">  403</a></b>  * the authentication. The following define is to aid applications in 
<b><a name="404">  404</a></b>  * documenting that is what it's trying to do */
<b><a name="405">  405</a></b> #define <a href="#405">PK11_PW_TRY</a>                "TRY"   /* Default: a prompt has been presented
<b><a name="406">  406</a></b>                                          * to the user, initiate a C_Login
<b><a name="407">  407</a></b>                                          * to authenticate the token */
<b><a name="408">  408</a></b> 
<b><a name="409">  409</a></b> /*
<b><a name="410">  410</a></b>  * PKCS #11 key structures
<b><a name="411">  411</a></b>  */
<b><a name="412">  412</a></b> 
<b><a name="413">  413</a></b> /*
<b><a name="414">  414</a></b> ** Attributes
<b><a name="415">  415</a></b> */
<b><a name="416">  416</a></b> struct <a href="#416">SECKEYAttributeStr</a> {
<b><a name="417">  417</a></b>     <a href="../util/seccomon.h.dep.html#SECItem">SECItem</a> attrType;
<b><a name="418">  418</a></b>     <a href="../util/seccomon.h.dep.html#SECItem">SECItem</a> **attrValue;
<b><a name="419">  419</a></b> };
<b><a name="420">  420</a></b> typedef struct <a href="#420">SECKEYAttribute</a>Str SECKEYAttribute;
<b><a name="421">  421</a></b> 
<b><a name="422">  422</a></b> /*
<b><a name="423">  423</a></b> ** A PKCS#8 private key info object
<b><a name="424">  424</a></b> */
<b><a name="425">  425</a></b> struct <a href="#425">SECKEYPrivateKeyInfoStr</a> {
<b><a name="426">  426</a></b>     <a href="../mozilla/nsprpub/lib/ds/plarena.h.dep.html#PLArenaPool">PLArenaPool</a><a href="../mozilla/nsprpub/lib/ds/plarenas.h.dep.html#PLArenaPool"><sup>[1]</sup></a> *arena;
<b><a name="427">  427</a></b>     <a href="../util/seccomon.h.dep.html#SECItem">SECItem</a> <a href="../mozilla/security/nss/cmd/zlib/deflate.c.dep.html#version">version</a></a><a href="../mozilla/security/nss/cmd/zlib/infback.c.dep.html#version"><sup>[2]</sup></a><a href="../mozilla/security/nss/cmd/zlib/inflate.c.dep.html#version"><sup>[3]</sup></a></a>;
<b><a name="428">  428</a></b>     <a href="../util/secoidt.h.dep.html#SECAlgorithmID">SECAlgorithmID</a> algorithm;
<b><a name="429">  429</a></b>     <a href="../util/seccomon.h.dep.html#SECItem">SECItem</a> privateKey;
<b><a name="430">  430</a></b>     <a href="../pk11wrap/secmodt.h.dep.html#SECKEYAttribute">SECKEYAttribute</a> **attributes;
<b><a name="431">  431</a></b> };
<b><a name="432">  432</a></b> typedef struct <a href="#432">SECKEYPrivateKeyInfo</a>Str SECKEYPrivateKeyInfo;
<b><a name="433">  433</a></b> 
<b><a name="434">  434</a></b> /*
<b><a name="435">  435</a></b> ** A PKCS#8 private key info object
<b><a name="436">  436</a></b> */
<b><a name="437">  437</a></b> struct <a href="#437">SECKEYEncryptedPrivateKeyInfoStr</a> {
<b><a name="438">  438</a></b>     <a href="../mozilla/nsprpub/lib/ds/plarena.h.dep.html#PLArenaPool">PLArenaPool</a><a href="../mozilla/nsprpub/lib/ds/plarenas.h.dep.html#PLArenaPool"><sup>[1]</sup></a> *arena;
<b><a name="439">  439</a></b>     <a href="../util/secoidt.h.dep.html#SECAlgorithmID">SECAlgorithmID</a> algorithm;
<b><a name="440">  440</a></b>     <a href="../util/seccomon.h.dep.html#SECItem">SECItem</a> encryptedData;
<b><a name="441">  441</a></b> };
<b><a name="442">  442</a></b> typedef struct <a href="../pk11wrap/secmodt.h.dep.html#<a href="#442">SECKEYEncryptedPrivateKeyInfo</a>Str">SECKEYEncryptedPrivateKeyInfoStr</a> SECKEYEncryptedPrivateKeyInfo;
<b><a name="443">  443</a></b> 
<b><a name="444">  444</a></b> /*
<b><a name="445">  445</a></b>  * token removal detection
<b><a name="446">  446</a></b>  */
<b><a name="447">  447</a></b> typedef enum {
<b><a name="448">  448</a></b>    PK11TokenNotRemovable = 0,
<b><a name="449">  449</a></b>    PK11TokenPresent = 1,
<b><a name="450">  450</a></b>    PK11TokenChanged = 2,
<b><a name="451">  451</a></b>    PK11TokenRemoved = 3
<b><a name="452">  452</a></b> } <a href="#452">PK11TokenStatus</a>;
<b><a name="453">  453</a></b> 
<b><a name="454">  454</a></b> typedef enum {
<b><a name="455">  455</a></b>    PK11TokenRemovedOrChangedEvent = 0,
<b><a name="456">  456</a></b>    PK11TokenPresentEvent = 1
<b><a name="457">  457</a></b> } <a href="#457">PK11TokenEvent</a>;
<b><a name="458">  458</a></b> 
<b><a name="459">  459</a></b> /*
<b><a name="460">  460</a></b>  * CRL Import Flags
<b><a name="461">  461</a></b>  */
<b><a name="462">  462</a></b> #define <a href="#462">CRL_IMPORT_DEFAULT_OPTIONS</a> 0x00000000
<b><a name="463">  463</a></b> #define <a href="#463">CRL_IMPORT_BYPASS_CHECKS</a>   0x00000001
<b><a name="464">  464</a></b> 
<b><a name="465">  465</a></b> #endif /*_SECMODT_H_ */
</pre>


<?
require_once "{$config['file_root']}/includes/footer.inc.php"
?>
