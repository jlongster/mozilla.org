<?php

$html_title = 'Certificate Functions
';

$menu = array(
    'id' => 'default',
);

require_once "{$config['file_root']}/includes/header.inc.php"

?>

<FONT SIZE=-1><A HREF="index.html">Table of Contents</A> | <A HREF="sslfnc.html">Previous</A>
 | <A HREF="sslkey.html">Next</A>
 | <A HREF="bklast.html">Index</A>
</FONT><BR><BR>


<BR>
<HR>
<A NAME="1022819">
<P></A><CENTER><H2>Chapter 5<BR>
<A NAME="1047959">
Certificate Functions</A></H2></CENTER>
<A NAME="1052174">
This chapter describes the functions and related types used to work with a certificate database such as the <CODE>cert7.db</CODE> database provided with Communicator.</A></P>
<A NAME="1060411">
<A HREF="sslcrt.html#1060423">Validating Certificates</A><br><A HREF="sslcrt.html#1056436">Manipulating Certificates</A><br><A HREF="sslcrt.html#1056475">Getting Certificate Information</A><br><A HREF="sslcrt.html#1055384">Comparing SecItem Objects</A></A></P>

<H2><A NAME="Validating Certificates"></A>
<A NAME="1060423">
 Validating Certificates
</A></H2><A NAME="1057997">
<A HREF="sslcrt.html#1058011"><CODE>CERT_VerifyCertNow</CODE></A><br><A HREF="sslcrt.html#1050342"><CODE>CERT_VerifyCertName</CODE></A><br><A HREF="sslcrt.html#1056662"><CODE>CERT_CheckCertValidTimes</CODE></A><br><A HREF="sslcrt.html#1056760"><CODE>NSS_CmpCertChainWCANames</CODE></A></A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1058011">
 CERT_VerifyCertNow
</A></H4>

<A NAME="1050762">
Checks that the current date is within the certificate's validity period and that the CA signature on the certificate is valid.</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1050633">
 Syntax
</A></H5>

<PRE><A NAME="1050648">#include &lt;cert.h&gt; </A></PRE><PRE><A NAME="1052833">SECStatus CERT_VerifyCertNow(<br>&nbsp;&nbsp;&nbsp;CERTCertDBHandle *handle, <br>&nbsp;&nbsp;&nbsp;CERTCertificate *cert,<br>&nbsp;&nbsp;&nbsp;PRBool checkSig, <br>&nbsp;&nbsp;&nbsp;SECCertUsage certUsage, <br>&nbsp;&nbsp;&nbsp;void *wincx);</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1050863">
 Parameters
</A></H5>

<A NAME="1051016">
This function has the following parameters:<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051013">handle</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051015">
A pointer to the certificate database handle.</A></P></TD></TR>
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051038">cert</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051040">
A pointer to the certificate to be checked.</A></P></TD></TR>
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051034">checkSig</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051036">
Indicates whether certificate signatures are to be checked. <CODE>PR_TRUE</CODE> means certificate signatures are to be checked. <CODE>PR_FALSE</CODE> means certificate signatures will not be checked.</A></P></TD></TR>
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051030">certUsage</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051032">
One of these values:</A></P><ul></P><LI><A NAME="1053742">
<CODE>certUsageSSLClient</CODE> </A></P><LI><A NAME="1053743">
<CODE>certUsageSSLServer</CODE> </A></P><LI><A NAME="1053744">
<CODE>certUsageSSLServerWithStepUp</CODE> </A></P><LI><A NAME="1053745">
<CODE>certUsageSSLCA</CODE> </A></P><LI><A NAME="1053746">
<CODE>certUsageEmailSigner</CODE> </A></P><LI><A NAME="1053747">
<CODE>certUsageEmailRecipient</CODE> </A></P><LI><A NAME="1053748">
<CODE>certUsageObjectSigner</CODE> </A></P><LI><A NAME="1053749">
<CODE>certUsageUserCertImport</CODE> </A></P><LI><A NAME="1053750">
<CODE>certUsageVerifyCA</CODE> </A></P><LI><A NAME="1053751">
<CODE>certUsageProtectedObjectSigner</CODE> </A></ul></TD></TR>
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051026">wincx</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051028">
The PIN argument value to pass to PK11 functions. See description below for more information.</A></P></TD></TR>

</TABLE>
</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1051405">
 Returns
</A></H5>

<A NAME="1051406">
The function returns one of these values:</A></P>
<ul><P><LI><A NAME="1051407">
If successful, <CODE>SECSuccess</CODE>.</A></LI>
<LI><A NAME="1051410">
If unsuccessful, <CODE>SECFailure</CODE>. Use <A href="../../../../../nspr/reference/html/prerr.html#26127"><CODE>PR_GetError</A></CODE> to obtain the error code.
</A></LI></ul><H5><A NAME="Head4;"></A>
<A NAME="1050903">
 Description
</A></H5>

<A NAME="1050915">
The <CODE>CERT_VerifyCertNow</CODE> function must call one or more PK11 functions to obtain the services of a PKCS #11 module. Some of the PK11 functions require a PIN argument (see <A HREF="sslfnc.html#1088040"><CODE>SSL_SetPKCS11PinArg</CODE></A> for details), which must be specified in the <CODE>wincx</CODE> parameter. To obtain the value to pass in the <CODE>wincx</CODE> parameter, call <A HREF="sslfnc.html#1123385"><CODE>SSL_RevealPinArg</CODE></A>. </A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1050342">
 CERT_VerifyCertName
</A></H4>

<A NAME="1058867">
Compares the common name specified in the subject DN for a certificate with a specified hostname. </A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1050521">
 Syntax
</A></H5>

<PRE><A NAME="1058759">#include &lt;cert.h&gt;</A></PRE><PRE><A NAME="1058760">SECStatus CERT_VerifyCertName(<br>&nbsp;&nbsp;&nbsp;CERTCertificate *cert, <br>&nbsp;&nbsp;&nbsp;char *hostname);</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1051266">
 Parameters
</A></H5>

<A NAME="1051252">
This function has the following parameters:<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051233">cert</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051235">
A pointer to the certificate against which to check the hostname referenced by <CODE>hostname</CODE>.</A></P></TD></TR>
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051237">hostname</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051239">
The hostname to be checked.</A></P></TD></TR>

</TABLE>
</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1051424">
 Returns
</A></H5>

<A NAME="1051425">
The function returns one of these values:</A></P>
<ul><P><LI><A NAME="1051426">
If the common name in the subject DN for the certificate matches the domain name passed in the <CODE>hostname</CODE> parameter, <CODE>SECSuccess</CODE>.</A></LI>
<LI><A NAME="1061277">
If the common name in the subject DN for the certificate is not identical to the domain name passed in the <CODE>hostname</CODE> parameter, <CODE>SECFailure</CODE>. Use <A href="../../../../../nspr/reference/html/prerr.html#26127"><CODE>PR_GetError</A></CODE> to obtain the error code. 
</A></LI></ul><H5><A NAME="Head4;"></A>
<A NAME="1059565">
 Description
</A></H5>

<A NAME="1059615">
The comparison performed by CERT_VerifyCertName is not a simple string comparison. Instead, it takes account of the following rules governing the construction of common names in SSL server certificates:</A></P>
<ul><P><LI><A NAME="1060868">
<CODE>*</CODE> matches anything </A></LI>
<P><LI><A NAME="1060869">
<CODE>?</CODE> matches one character </A></LI>
<P><LI><A NAME="1060870">
<CODE>\</CODE> escapes a special character </A></LI>
<P><LI><A NAME="1060871">
<CODE>$</CODE> matches the end of the string </A></LI>
<P><LI><A NAME="1060872">
<CODE>[abc]</CODE> matches one occurrence of <CODE>a</CODE>, <CODE>b</CODE>, or <CODE>c</CODE>. The only character that needs to be escaped in this is <CODE>]</CODE>, all others are not special. </A></LI>
<P><LI><A NAME="1061100">
<CODE>[a-z]</CODE> matches any character between <CODE>a</CODE> and <CODE>z</CODE> </A></LI>
<P><LI><A NAME="1061101">
<CODE>[^az]</CODE> matches any character except <CODE>a</CODE> or <CODE>z</CODE> </A></LI>
<P><LI><A NAME="1061102">
<CODE>~</CODE> followed by another shell expression removes any pattern matching the shell expression from the match list </A></LI>
<P><LI><A NAME="1059739">
<CODE>(foo|bar)</CODE> matches either the substring <CODE>foo</CODE> or the substring <CODE>bar</CODE>. These can be shell expressions as well. </A></LI>
</ul>
<H4><A NAME="Head3;"></A>
<A NAME="1056662">
 CERT_CheckCertValidTimes 
</A></H4>

<A NAME="1056663">
Checks whether a specified time is within a certificate's validity period. </A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1056664">
 Syntax
</A></H5>

<PRE><A NAME="1056665">#include &lt;cert.h&gt;<br>#include &lt;certt.h&gt;</A></PRE><PRE><A NAME="1056666">SECCertTimeValidity CERT_CheckCertValidTimes(<br>&nbsp;&nbsp;&nbsp;CERTCertificate *cert,<br>&nbsp;&nbsp;&nbsp;int64 t);</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1056667">
 Parameters
</A></H5>

<A NAME="1056677">
This function has the following parameters:<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1056670">cert</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1056672">
A pointer to the certificate whose validity period you want to check against.</A></P></TD></TR>
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1056674">t</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1056676">
The time to check against the certificate's validity period. For more information, see the NSPR header <CODE>pr_time.h</CODE>.</A></P></TD></TR>

</TABLE>
</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1056678">
 Returns
</A></H5>

<A NAME="1056679">
The function returns an enumerator of type <CODE>SECCertTimeValidity</CODE>:</A></P>
<PRE><A NAME="1056680">typedef enum {<br>&nbsp;&nbsp;&nbsp;secCertTimeValid,<br>&nbsp;&nbsp;&nbsp;secCertTimeExpired,<br>&nbsp;&nbsp;&nbsp;secCertTimeNotValidYet<br>} SECCertTimeValidity;</A></PRE>
<H4><A NAME="Head3;"></A>
<A NAME="1056760">
 NSS_CmpCertChainWCANames
</A></H4>

<A NAME="1056761">
Determines whether any of the signers in the certificate chain for a specified certificate are on a specified list of CA names.</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1056762">
 Syntax
</A></H5>

<PRE><A NAME="1056763">#include &lt;nss.h&gt;</A></PRE><PRE><A NAME="1056764">SECStatus NSS_CmpCertChainWCANames(<br>&nbsp;&nbsp;&nbsp;CERTCertificate *cert, <br>&nbsp;&nbsp;&nbsp;CERTDistNames *caNames);</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1056765">
 Parameters
</A></H5>

<A NAME="1056775">
This function has the following parameters:<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1056768">cert</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1056770">
A pointer to the certificate structure for the certificate whose certificate chain is to be checked. </A></P></TD></TR>
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1056772">caNames</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1056774">
A pointer to a structure that contains a list of distinguished names (DNs) against which to check the DNs for the signers in the certificate chain.</A></P></TD></TR>

</TABLE>
</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1056776">
 Returns
</A></H5>

<A NAME="1056777">
The function returns one of these values:</A></P>
<ul><P><LI><A NAME="1056778">
If successful, <CODE>SECSuccess</CODE>.</A></LI>
<LI><A NAME="1056781">
If unsuccessful, <CODE>SECFailure</CODE>. Use <A href="../../../../../nspr/reference/html/prerr.html#26127"><CODE>PR_GetError</A></CODE> to obtain the error code.
</A></LI></ul>
<H2><A NAME="Manipulating Certificates"></A>
<A NAME="1056436">
 Manipulating Certificates
</A></H2><A NAME="1058315">
<A HREF="sslcrt.html#1058344"><CODE>CERT_DupCertificate</CODE></A><br><A HREF="sslcrt.html#1050532"><CODE>CERT_DestroyCertificate</CODE></A></A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1058344">
 CERT_DupCertificate
</A></H4>

<A NAME="1050514">
Makes a shallow copy of a specified certificate. </A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1051369">
 Syntax
</A></H5>

<PRE><A NAME="1051374">#include &lt;cert.h&gt;</A></PRE><PRE><A NAME="1052965">CERTCertificate *CERT_DupCertificate(CERTCertificate *c)</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1051446">
 Parameter
</A></H5>

<A NAME="1051456">
This function has the following parameter:<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051449">c</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051451">
A pointer to the certificate object to be duplicated.</A></P></TD></TR>

</TABLE>
</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1051393">
 Returns
</A></H5>

<A NAME="1051520">
If successful, the function returns a pointer to a certificate object of type <A HREF="ssltyp.html#1027387"><CODE>CERTCertificate</CODE></A>. </A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1051522">
 Description
</A></H5>

<A NAME="1051543">
The <CODE>CERT_DupCertificate</CODE> function increments the reference count for the certificate passed in the <CODE>c</CODE> parameter.</A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1050532">
 CERT_DestroyCertificate
</A></H4>

<A NAME="1050533">
Destroys a certificate object.</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1050534">
 Syntax
</A></H5>

<PRE><A NAME="1050535">#include &lt;cert.h&gt;<br>#include &lt;certt.h&gt;</A></PRE><PRE><A NAME="1050536">void CERT_DestroyCertificate(CERTCertificate *cert);</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1050537">
 Parameters
</A></H5>

<A NAME="1050543">
This function has the following parameter:<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1050540">cert</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1050542">
A pointer to the certificate to destroy. </A></P></TD></TR>

</TABLE>
</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1050546">
 Description
</A></H5>

<A NAME="1059763">
Certificate and key structures are shared objects. When an application makes a copy of a particular certificate or key structure that already exists in memory, SSL makes a <I>shallow</I> copy--that is, it increments the reference count for that object rather than making a whole new copy. When you call <A HREF="sslcrt.html#1050532"><CODE>CERT_DestroyCertificate</CODE></A> or <A HREF="sslkey.html#1051017"><CODE>SECKEY_DestroyPrivateKey</CODE></A>, the function decrements the reference count and, if the reference count reaches zero as a result, both frees the memory and sets all the bits to zero. The use of the word "destroy" in function names or in the description of a function implies reference counting.</A></P>
<A NAME="1059770">
Never alter the contents of a certificate or key structure. If you attempt to do so, the change affects all the shallow copies of that structure and can cause severe problems.</A></P>

<H2><A NAME="Getting Certificate Information"></A>
<A NAME="1056475">
 Getting Certificate Information
</A></H2><A NAME="1058477">
<A HREF="sslcrt.html#1050345"><CODE>CERT_FindCertByName</CODE></A><br><A HREF="sslcrt.html#1050346"><CODE>CERT_GetCertNicknames</CODE></A><br><A HREF="sslcrt.html#1050349"><CODE>CERT_FreeNicknames</CODE></A><br><A HREF="sslcrt.html#1052308"><CODE>CERT_GetDefaultCertDB</CODE></A><br><A HREF="sslcrt.html#1056950"><CODE>NSS_FindCertKEAType</CODE></A></A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1050345">
 CERT_FindCertByName
</A></H4>

<A NAME="1050500">
Finds the certificate in the certificate database with a specified DN.</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1051704">
 Syntax
</A></H5>

<PRE><A NAME="1051729">#include &lt;cert.h&gt;</A></PRE><PRE><A NAME="1053000">CERTCertificate *CERT_FindCertByName (<br>&nbsp;&nbsp;&nbsp;CERTCertDBHandle *handle, <br>&nbsp;&nbsp;&nbsp;SECItem *name);</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1051753">
 Parameters
</A></H5>

<A NAME="1051763">
This function has the following parameters:<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051756">handle</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051758">
A pointer to the certificate database handle.</A></P></TD></TR>
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051760">name</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051762">
The subject DN of the certificate you wish to find.</A></P></TD></TR>

</TABLE>
</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1051807">
 Returns
</A></H5>

<A NAME="1051811">
If successful, the function returns a certificate object of type <A HREF="ssltyp.html#1027387"><CODE>CERTCertificate</CODE></A>. </A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1050346">
 CERT_GetCertNicknames
</A></H4>

<A NAME="1050493">
Returns the nicknames of the certificates in a specified certificate database.</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1051829">
 Syntax
</A></H5>

<PRE><A NAME="1051868">#include &lt;cert.h&gt;<br>#include &lt;certt.h&gt;</A></PRE><PRE><A NAME="1053022">CERTCertNicknames *CERT_GetCertNicknames (<br>&nbsp;&nbsp;&nbsp;CERTCertDBHandle *handle,<br>&nbsp;&nbsp;&nbsp;int what, <br>&nbsp;&nbsp;&nbsp;void *wincx);</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1051901">
 Parameters
</A></H5>

<A NAME="1051911">
This function has the following parameters:<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051904">handle</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051906">
A pointer to the certificate database handle.</A></P></TD></TR>
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051908">what</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1051910">
One of these values: </A></P><ul></P><LI><A NAME="1054198">
<CODE>SEC_CERT_NICKNAMES_ALL</CODE></A></P><LI><A NAME="1054208">
<CODE>SEC_CERT_NICKNAMES_USER</CODE></A></P><LI><A NAME="1054231">
<CODE>SEC_CERT_NICKNAMES_SERVER</CODE></A></P><LI><A NAME="1054213">
<CODE>SEC_CERT_NICKNAMES_CA</CODE></A></ul></TD></TR>
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1051916">wincx</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1054859">
The PIN argument value to pass to PK11 functions. See description below for more information.</A></P></TD></TR>

</TABLE>
</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1051896">
 Returns
</A></H5>

<A NAME="1051935">
The function returns a <CODE>CERTCertNicknames</CODE> object containing the requested nicknames.</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1054904">
 Description
</A></H5>

<A NAME="1054920">
<CODE>CERT_GetCertNicknames</CODE> must call one or more PK11 functions to obtain the services of a PKCS #11 module. Some of the PK11 functions require a PIN argument (see <A HREF="sslfnc.html#1088040"><CODE>SSL_SetPKCS11PinArg</CODE></A> for details), which must be specified in the <CODE>wincx</CODE> parameter. To obtain the value to pass in the <CODE>wincx</CODE> parameter, call <A HREF="sslfnc.html#1123385"><CODE>SSL_RevealPinArg</CODE></A>. </A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1050349">
 CERT_FreeNicknames
</A></H4>

<A NAME="1052160">
Frees a <CODE>CERTCertNicknames</CODE> structure. This structure is returned by <A HREF="sslcrt.html#1050346"><CODE>CERT_GetCertNicknames</CODE></A>. </A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1052164">
 Syntax
</A></H5>

<PRE><A NAME="1053074">#include &lt;cert.h&gt;</A></PRE><PRE><A NAME="1050481">void CERT_FreeNicknames(CERTCertNicknames *nicknames);</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1052221">
 Parameters
</A></H5>

<A NAME="1052227">
This function has the following parameter:<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1052224">nicknames</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1052226">
A pointer to the <CODE>CERTCertNicknames</CODE> structure to be freed. </A></P></TD></TR>

</TABLE>
 </A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1052308">
 CERT_GetDefaultCertDB 
</A></H4>

<A NAME="1052309">
Returns a handle to the default certificate database.</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1052310">
 Syntax
</A></H5>

<PRE><A NAME="1053125">#include &lt;cert.h&gt;</A></PRE><PRE><A NAME="1052312">CERTCertDBHandle *CERT_GetDefaultCertDB(void);</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1052316">
 Returns
</A></H5>

<A NAME="1052318">
The function returns the <A HREF="ssltyp.html#1028465"><CODE>CERTCertDBHandle</CODE></A> for the default certificate database.</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1052326">
 Description
</A></H5>

<A NAME="1052327">
This function is useful for determining whether the default certificate database has been opened.</A></P>

<H4><A NAME="Head3;"></A>
<A NAME="1056950">
 NSS_FindCertKEAType
</A></H4>

<A NAME="1056951">
Returns key exchange type of the keys in an SSL server certificate. </A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1056952">
 Syntax
</A></H5>

<PRE><A NAME="1058811">#include &lt;nss.h&gt;</A></PRE><PRE><A NAME="1058812">SSLKEAType NSS_FindCertKEAType(CERTCertificate * cert);</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1056954">
 Parameter
</A></H5>

<A NAME="1056960">
This function has the following parameter:<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1056957">a</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1056959">
The certificate to check. </A></P></TD></TR>

</TABLE>
</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1056961">
 Returns
</A></H5>

<A NAME="1056962">
The function returns one of these values:</A></P>
<ul><P><LI><A NAME="1056963">
<CODE>kt_null = 0</CODE> </A></LI>
<P><LI><A NAME="1056964">
<CODE>kt_rsa</CODE> </A></LI>
<P><LI><A NAME="1056965">
<CODE>kt_dh</CODE> </A></LI>
<P><LI><A NAME="1056966">
<CODE>kt_fortezza</CODE> </A></LI>
<P><LI><A NAME="1056967">
<CODE>kt_kea_size </CODE></A></LI>
</ul>
<H2><A NAME="Comparing SecItem Objects"></A>
<A NAME="1055384">
 Comparing SecItem Objects
</A></H2>
<H4><A NAME="Head3;"></A>
<A NAME="1057028">
 SECITEM_CompareItem
</A></H4>

<A NAME="1057032">
Compares two <A HREF="ssltyp.html#1026076"><CODE>SECItem</CODE></A> objects and returns a <CODE>SECComparison</CODE> enumerator that shows the difference between them.</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1057033">
 Syntax
</A></H5>

<PRE><A NAME="1057034">#include &lt;secitem.h&gt;<br>#include &lt;seccomon.h&gt;</A></PRE><PRE><A NAME="1057035">SECComparison SECITEM_CompareItem(<br>&nbsp;&nbsp;&nbsp;SECItem *a, <br>&nbsp;&nbsp;&nbsp;SECItem *b);</A></PRE><H5><A NAME="Head4;"></A>
<A NAME="1057036">
 Parameters
</A></H5>

<A NAME="1057046">
This function has the following parameters:<TABLE BORDER="0">
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1057039">a</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1057041">
A pointer to one of the items to be compared. </A></P></TD></TR>
<TR><TD VALIGN=baseline ALIGN=left><PRE><A NAME="1057043">b</A></PRE></TD><TD VALIGN=baseline ALIGN=left><P><A NAME="1057045">
A pointer to one of the items to be compared.</A></P></TD></TR>

</TABLE>
</A></P>
<H5><A NAME="Head4;"></A>
<A NAME="1057047">
 Returns
</A></H5>

<A NAME="1057048">
The function returns an enumerator of type <CODE>SECComparison</CODE>.</A></P>
<PRE><A NAME="1057049">typedef enum _SECComparison {<br>&nbsp;&nbsp;&nbsp;SECLessThan &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= -1,<br>&nbsp;&nbsp;&nbsp;SECEqual &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 0,<br>&nbsp;&nbsp;&nbsp;SECGreaterThan = 1<br>} SECComparison;</A></PRE><A NAME="1057024">
</A></P>

<HR>

<FONT SIZE=-1><A HREF="index.html">Table of Contents</A> | <A HREF="sslfnc.html">Previous</A>
 | <A HREF="sslkey.html">Next</A>
 | <A HREF="bklast.html">Index</A>
</FONT>
<P ALIGN=right>
<FONT SIZE=-2><I>Last Updated:  10/18/00  09:17:47</I></FONT>
<P> 



<?
require_once "{$config['file_root']}/includes/footer.inc.php"
?>
