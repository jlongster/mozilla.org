<?php

$html_title = 'Regress: A Test Suite Automation and Reporting Tool';

$menu = array(
    'id' => 'default',
);

require_once "{$config['file_root']}/includes/header.inc.php"

?>

<center>
<h2>Regress: A Test Suite Automation and Reporting Tool</h2>
<i><FONT SIZE="-1">

Newsgroup: 
<A HREF="news://news.mozilla.org/mozilla.dev.tech.crypto">mozilla.dev.tech.crypto</A><BR>

Technical contact: 
<A HREF="mailto:relyea@netscape.com?subject=Regress Tool Feedback">Bob Relyea</A><BR>

Yell at the manager: 
<A HREF="mailto:lord@netscape.com?subject=Regress Tool Feedback">Bob Lord</A></FONT></i>
</center>

<H3>
Overview</H3>
Regress is a test case execution and reporting tool that operates as follows.
It accepts a specification file [that is intended to be platform and location
independent] that defines a number of test cases (programs) and a description
for each case.&nbsp; Regress runs the series of programs, in the order
of the specfile, and captures into an html output file a table of results:&nbsp;
the date/time of run, program run, and results (PASS or FAIL).&nbsp;&nbsp;
Regress also generates a summary output file suitable for collecting overall
results from a number of test suites.&nbsp; Regress generates results that
are utilized by <A HREF="reporter.html">reporter</A>.
<H3>
Command line interface</H3>

<PRE>&nbsp;&nbsp; regress specfile=filename [htmldir=dir] [progdir=dir] [debug]</PRE>
[commands in brackets are optional]

<P><B>specfile</B> specifies the input specfile (defined below) that regress
uses to find out what to execute. The path to the file can be relative
or absolute.
<BR>If <B>debug</B> is in the command line, information will be output
to STDOUT so developers of regress can see what is going on.
<BR><B>progdir</B> specifies the base directory where all the executables
are. It could be a relative or absolute path.
<BR><B>htmldir </B>specifies the base directory where all the html results
and reporter specs are output to. It could be a relative or absolute path.

<P>When specifying directories in this document, it is not necessary to
worry about the "/" vs. the "\" conventions. The regression tool will figure
out which slash to use.
<BR>&nbsp;
<TABLE BORDER >
<TR>
<TD><B>Error Codes</B></TD>

<TD><B>Description</B></TD>
</TR>

<TR>
<TD><B>0</B></TD>

<TD>No error</TD>
</TR>

<TR>
<TD><B>1</B></TD>

<TD>Did not include specfile= directive on command line</TD>
</TR>

<TR>
<TD><B>2</B></TD>

<TD>Specfile is malformed or does not exist</TD>
</TR>

<TR>
<TD><B>3</B></TD>

<TD>No [General] section in specfile&nbsp;</TD>
</TR>

<TR>
<TD><B>4</B></TD>

<TD>No mut= line in [General] section</TD>
</TR>

<TR>
<TD><B>5</B></TD>

<TD>No mutversion= line in [General] section</TD>
</TR>

<TR>
<TD><B>6</B></TD>

<TD>No htmlout= line in [General] section</TD>
</TR>

<TR>
<TD><B>7</B></TD>

<TD>No platform= line in [General] section</TD>
</TR>

<TR>
<TD><B>8</B></TD>

<TD>No reporterSpec= line in [General] section</TD>
</TR>
</TABLE>
<B>Tests should use exit codes from the range of 1 to 255 due to Unix limitation
on transferred exit codes. 256 exit code is reserved for test crash.</B>

<H3>
Input</H3>
<B>The following is a specification of the regress tools Test Case Specification
file:</B>
<BR>&nbsp;
<TABLE BORDER >
<TR>
<TD><B>Specification File Element</B></TD>

<TD><B>Description of Element</B></TD>
</TR>

<TR>
<TD>[<B>General]</B></TD>

<TD>Starts the General information block that describes the collection
of unit tests in this directory.</TD>
</TR>

<TR>
<TD><B>mut=description</B></TD>

<TD>Defines a description for the <B>module under test</B> (e.g., ns/security/lib/crypto
module could be described as "Security Library: Cryptographic Module (lib/crypto)".</TD>
</TR>

<TR>
<TD><B>mutversion=versionstring</B></TD>

<TD>Defines a <B>version string</B> for the collection of tests. It is
assumed that each test will execute against this higher level versionstring
version, and that the results will be reported against this version string.</TD>
</TR>

<TR>
<TD><B>htmlout=&lt;filename></B></TD>

<TD>Defines the <B>location and filename relative to htmldir of the html
test output that is generated by the regress tool</B>. If the &lt;filename>
is NOW, then a yyyymmdd.html string will be substituted for the filename
(eg. 19970801). This has to be a relative path to the <B>htmldir </B>specified
above. If <B>htmldir</B> is not set, it is automatically default to "."</TD>
</TR>

<TR>
<TD><B>reporterSpec=&lt;filename></B></TD>

<TD>Defines the <B>location and filename of the specfile that is generated
by the regress tool and read in by the <A HREF="reporter.html">reporter
tool</A>).</B> (See also <A HREF="reporter.html#specfiles">specification</A> of reporter
specfile.) If the &lt;filename> is NOW, then a yyyymmdd.rpt string will
be substituted for the filename (eg. 19970801). This has to be a relative
path to the <B>htmldir </B>specified above. If <B>htmldir</B> is not set,
it is automatically default to "."&nbsp;</TD>
</TR>

<TR>
<TD><B>program=&lt;filename></B></TD>

<TD>Program name placed in general section is used with single source testing
method only, which also requires to have test IDs in the individual test
sections.</TD>
</TR>

<TR>
<TD><B>globalArgs=&lt;arg list string></B></TD>

<TD>Defines a list of arguments tacked on to all of the programs when the
regression suite is run (this will simply concatenate the &lt;program>&lt;space>&lt;globalArgs>
together). <B>This header is optional.</B></TD>
</TR>

<TR>
<TD><B>bugQueryUrl=&lt;URL with metavariable></B></TD>

<TD>Defines a URL that has a metavariable $[BUG-NUMBER] that is replaced
by the bug number when a test is a known failure. <B>This header is optional.</B></TD>
</TR>

<TR>
<TD><B>[Test-X]</B></TD>

<TD>Begins an information block for a specific test. The X value must be
replaced with an integer >= 1. The following name value pairs are related
to each [Test-X] block.</TD>
</TR>

<TR>
<TD><B>program=&lt;filename></B></TD>

<TD>This is the relative path (relative to the <B>progdir</B>) to the executable.
This is the program to execute that calls <B>PR_ProcessExit</B> or <B>return</B>
and returns a 0 for success, or 1 for failure. If <B>progdir</B> is not
set, <B>progdir</B> is defauted to "." It is not necessary to add a ".exe"
extension at the end of the program name when specifying a Windows / DOS
executable.&nbsp;
<BR>Program won’t be specified in this section with single source testing
method.</TD>
</TR>

<TR>
<TD><B>testId=&lt;test ID></B></TD>

<TD><B>testId</B>&nbsp; is used with single source testing method only.
It is transferred to the test as a first argument.</TD>
</TR>

<TR>
<TD><B>testname=&lt;description></B></TD>

<TD>This is the description of what the test program is testing.&nbsp;</TD>
</TR>

<TR>
<TD><B>timeout=&lt;integer></B></TD>

<TD>This is the timeout in seconds to run a test. If a test runs longer
than the timeout, it is killed and returns fail. This field is optional.
If it is not set, timeout is automatically set to 10 seconds.</TD>
</TR>

<TR>
<TD><B>bug=&lt;integer></B></TD>

<TD><B>This is an optional field.</B> This is set whenever there is a known
test failure. The test
will NOT be run when this field is set.&nbsp;</TD>
</TR>

<TR>
<TD><B>include=&lt;platforms></B></TD>

<TD><B>This is an optional field.</B> This is set whenever a test is specific
to a certain platform or group of platforms. The test will be run only
on the platforms (separated by commas or whitespace) in the include list.Check
the <A HREF="#platform strings">list</A> for what string to use for your
platform. If your platform is not on the list, check the output platform
header in the output HTML to see the string you need to use.&nbsp;

<P>This field is case insensitive (eg. you can use solaris2.5 if you want).&nbsp;

<P>The test will result in a PASS if the platform is not in the include
list (The test didn't really fail, it just wasn't run).&nbsp;

<P><B>Note</B>: having both an include and exclude tag is invalid and will
result in an error.</TD>
</TR>

<TR>
<TD><B>exclude=&lt;platforms></B></TD>

<TD><B>This is an optional field.</B> This is set whenever a test is not
supposed to be run on a certain platform or group of platforms. The test
will not be run on the platforms (separated by commas or whitespace) in
the exclude list. Check the <A HREF="#platform strings">list</A> for what
string to use for your platform. If your platform is not on the list, check
the output platform header in the output HTML to see the string you need
to use.&nbsp;

<P>This field is case insensitive (eg. you can use solaris2.5 if you want).&nbsp;

<P>The test will result in a PASS if the platform is in the exclude list
(The test didn't really fail, it just wasn't run).&nbsp;

<P><B>Note</B>: having both an include and exclude tag is invalid and will
result in an error.</TD>
</TR>
</TABLE>
&nbsp;
<H3>
<A NAME="platform strings"></A>Platform strings</H3>
The following is a specification of sample platform strings you can use
for the <B>include </B>and <B>exclude </B>headers:

<P>SOLARIS2.5
<BR>SOLARIS2.4
<BR>SOLARIS2.3
<BR>WINNT
<BR>HPUXB.10.10
<BR>OSFV4.0
<BR>AIX1
<BR>IRIX5.3
<BR>IRIX6.2

<P>The following is a specification of what the return value should be
for each <B>Individual Test case executable</B>.

<P>Each of these test cases makes up one singular test within the overall
regression test suite. The regression test suite is defined by the Test
Specification File.
<TABLE BORDER WIDTH="87%" >
<TR>
<TD><B>Output Description</B></TD>

<TD><B>Format of Output</B></TD>
</TR>

<TR>
<TD>Test pass fail status indicator. The program must call PR_ProcessExit(0)
if the test passes. If any other value is returned, that means that the
test fails.</TD>

<TD>0&nbsp;&nbsp; -- PASS&nbsp;

<P>non-zero value -- FAIL</TD>
</TR>
</TABLE>
<I>It is a convention during failures to use the current line number of
the program or template as the return value for easier debugging.</I>

<P><B>Note:</B> If the Individual Test case requires known answers to benchmark
the results of the execution against, then it is the responsibility of
the individual test case to manage the creation / deletion of startup /
shutdown known answers.
<a name="output"><H3>
Output</H3></a>
The following is a specification of the<B> html output format </B>for the
<B>regress </B>tool:
<TABLE BORDER >
<TR>
<TD><B>Section Description</B></TD>

<TD><B>HTML format</B></TD>
</TR>

<TR>
<TD><B>Document Title</B>&nbsp;

<P>The <B>title </B>is generated from the <B>mut= </B>specifier. The <B>version
</B>is generated from <B>mutversion=</B>. The<B> date and time </B>is relative
to the beginning point of the execution of the regression test suite.</TD>

<TD><TT>&lt;HTML>&lt;HEAD>&lt;TITLE></TT><I>mut description</I>: <TT>Version:
</TT><I>mutversion</I> Platform: <I>platform</I> <TT>Run date mm/dd/yy&lt;/TITLE>&lt;/HEAD>&lt;BODY>\n</TT></TD>
</TR>

<TR>
<TD><B>H1 Header for the report.</B></TD>

<TD><TT>&lt;H1></TT><I>mut description</I>: <TT>Version: </TT><I>mutversion</I>
Platform: <I>platform </I><TT>Run date mm/dd/yy&lt;/H1>&lt;HR>\n</TT>&nbsp;
<BR>&nbsp;</TD>
</TR>

<TR>
<TD><B>Table header</B></TD>

<TD><TT>&lt;TABLE BORDER=1>&lt;TR>\n</TT>&nbsp;
<BR><TT>&lt;TD>&lt;B>Test Case Number&lt;/B>&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;TD>&lt;B>Program&lt;/B>&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;TD>&lt;B>Description of Test Case&lt;/B>&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;TD>&lt;B>Start date/time&lt;B>&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;TD>&lt;B>End date/time&lt;B>&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;TD>&lt;B>PASS/FAIL&lt;/B>&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;/TR>\n</TT></TD>
</TR>

<TR>
<TD><B>Table Detail</B>&nbsp;

<P>Open the output file defined by htmlout= specifier in the [General]
section of the specification file.&nbsp;

<P>For each test case header [Test-X] (X >= 1) in the Test Specification
file,&nbsp;
<UL>(1) Capture the date/time prior to execution (this is <B>start date/time</B>)&nbsp;
<BR>(2) Execute the program (program=filename) capturing the <B>return
code</B>. If program runs past timeout, kill the program.&nbsp;
<BR>(3) Capture the date/time after execution (<B>this is the end date/time)</B>.&nbsp;
<BR>(4) Generate the HTML ouptut -- if the specfile is missing some headers,
then the result is "MALFORMED". Otherwise, the result string is either
PASS or FAIL. If the test returns a pass, the test row is greyed out. If
the test fails, the result will be in <FONT COLOR="#FF0000">red</FONT>.</UL>
<B>Notes: </B>The &lt;description> is associated with [Test-X] and is the
description given after testname= in the specification block.&nbsp;</TD>

<TD><TT>&lt;TR [if pass then BG COLOR="#C0C0C0">]\n</TT>&nbsp;
<BR><TT>&lt;TD>&lt;B><B>X</B>&lt;/B>&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;TD><I>filename</I>&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;TD><I>description</I>&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;TD>mm/dd/yy hh:mm:ss&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;TD>mm/dd/yy hh:mm:ss&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;TD>&lt;B>&nbsp;</TT>&nbsp;
<BR><TT>PASS |</TT>&nbsp;
<BR><TT>PASS : This test was excluded or not included for this platform
|</TT>&nbsp;
<BR><TT><FONT COLOR="#000000">&lt;FONT COLOR="#FF0000"> FAIL: return code
= <I>errnum</I>. &lt;/FONT> |&nbsp;</FONT></TT>&nbsp;
<BR><TT><FONT COLOR="#000000">&lt;FONT COLOR="#FF0000"> FAIL: CreateProcess
&lt;/FONT> |&nbsp;</FONT></TT>&nbsp;
<BR><TT><FONT COLOR="#000000">&lt;FONT COLOR="#FF0000"> FAIL: WaitProcess
&lt;/FONT> |&nbsp;</FONT></TT>&nbsp;
<BR><TT><FONT COLOR="#000000">&lt;FONT COLOR="#FF0000"> FAIL: Known bug.
Bug number = 51325
&lt;/FONT> |&nbsp;</FONT></TT>&nbsp;
<BR><TT><FONT COLOR="#000000">&lt;FONT COLOR="#FF0000"> FAIL: Timeout after
10 seconds &lt;/FONT> |&nbsp;</FONT></TT>&nbsp;
<BR><TT>MALFORMED : include= and exclude= tags BOTH defined |</TT>&nbsp;
<BR><TT>MALFORMED : program= not defined in [header] |</TT>&nbsp;
<BR><TT>MALFORMED : testname= not defined in [header] |</TT>&nbsp;
<BR><TT>MALFORMED : test number=header-part not valid positive integer
|</TT>&nbsp;
<BR><TT>MALFORMED : test number header invalid</TT>&nbsp;
<BR><TT>&lt;/B>&lt;/TD>\n</TT>&nbsp;
<BR><TT>&lt;/TR>\n</TT></TD>
</TR>

<TR>
<TD><B>Table trailer</B></TD>

<TD>&lt;/TABLE>\n</TD>
</TR>

<TR>
<TD><B>Summary Line</B></TD>

<TD>&lt;TABLE>&nbsp;
<BR>&lt;TR>&lt;TD>&lt;B>Summary Results&lt;/B>&lt;/TD>&lt;TD>Count&lt;/TD>&lt;/TR>&nbsp;
<BR>&lt;TR>&lt;TD>Tests Failed&lt;/TD>&lt;TD>&lt;number failed>&lt;/TD>&lt;/TR>&nbsp;
<BR>&lt;TR>&lt;TD>Test Passed&lt;/TD>&lt;TD>&lt;number passed>&lt;/TD>&lt;/TR>&nbsp;
<BR>&lt;TR>&lt;TD>Known Failures&lt;/TD>&lt;TD>&lt;known failures>&lt;/TD>&lt;TR>&nbsp;
<BR>&lt;TR>&lt;TD>Malformed Specification&lt;/TD>&lt;TD>&lt;number malformed>&lt;/TD>&lt;/TR>&nbsp;
<BR>&lt;/TABLE>&nbsp;
<BR>&nbsp;</TD>
</TR>

<TR>
<TD><B>End of HTML</B></TD>

<TD><TT>&lt;/BODY>&lt;/HTML>\n</TT></TD>
</TR>
</TABLE>
The following is a specification of the<B> reporter specfile output format
</B>for the <B>regress </B>tool:
<BR>&nbsp;
<TABLE BORDER >
<TR>
<TD><B>Specification File Element</B></TD>

<TD><B>Description of Element</B></TD>
</TR>

<TR>
<TD><B>[Status]</B></TD>

<TD>Is the only block in this specification file</TD>
</TR>

<TR>
<TD><B>mut=description</B></TD>

<TD>Defines a description for the <B>module under test</B> (e.g., ns/security/lib/crypto
module could be described as "Security Library: Cryptographic Module (lib/crypto)".</TD>
</TR>

<TR>
<TD><B>mutversion=versionstring</B></TD>

<TD>Defines a <B>version string</B> for the collection of tests. It is
assumed that each test will execute against this higher level versionstring
version, and that the results will be reported against this versionstring.</TD>
</TR>

<TR>
<TD><B>platform=&lt;string></B></TD>

<TD>Defines the platform the tests were run under</TD>
</TR>

<TR>
<TD><B>pass=&lt;number></B></TD>

<TD>Number of tests that passed.</TD>
</TR>

<TR>
<TD><B>fail=&lt;number></B></TD>

<TD>Number of tests that failed due to non-zero return codes, timeouts,
OR any other abnormality when running the test.</TD>
</TR>

<TR>
<TD><B>knownFail=&lt;number></B></TD>

<TD>Number of tests that were known to fail because a bug number was specified
in its regress specfile.&nbsp;</TD>
</TR>

<TR>
<TD><B>malformed=&lt;number></B></TD>

<TD>Number of tests with bad headers.</TD>
</TR>
</TABLE>

<H3>
FAIL Code Descriptions</H3>

<TABLE BORDER COLS=2 WIDTH="100%" >
<TR>
<TD><B>Output</B></TD>

<TD><B>Description</B></TD>
</TR>

<TR>
<TD>FAIL: return code = 3</TD>

<TD>When the test program exits with non zero return code.</TD>
</TR>

<TR>
<TD>FAIL: Create Process</TD>

<TD>Regress could not run the program or create the process. This usually
means a misspelling of the program name, or that you are running on a machine
that does not support processes (possibly MAC)</TD>
</TR>

<TR>
<TD>FAIL: Wait Process</TD>

<TD>Regress could not get the return code of the process for some reason.</TD>ug
</TR>

<TR>
<TD>FAIL: Timeout after X seconds</TD>

<TD>The program ran longer than the alloted X seconds and was killed.</TD>
</TR>

<TR>
<TD>FAIL: Known bug. Bug number = 53416

<TD>The bug = tag in the specfile is set, so the test is a known bug.</TD>
</TR>

<TR>
<TD>FAIL: Known hang</TD>

<TD>A kludge in an older version of regress that recognizes special program
names that block forever and outputs this error instead of running them.</TD>
</TR>
</TABLE>
&nbsp;



<?
require_once "{$config['file_root']}/includes/footer.inc.php"
?>
