<?php

$html_title = 'Reporter Specification';

$menu = array(
    'id' => 'default',
);

require_once "{$config['file_root']}/includes/header.inc.php"

?>

<center>
<h2>Reporter Tool Specification</h2>
<i><FONT SIZE="-1">

Newsgroup: 
<A HREF="news://news.mozilla.org/mozilla.dev.tech.crypto">mozilla.dev.tech.crypto</A><BR>

Technical contact: 
<A HREF="mailto:relyea@netscape.com?subject=Reporter Spec Feedback">Bob Relyea</A><BR>

Yell at the manager: 
<A HREF="mailto:lord@netscape.com?subject=Reporter Spec Feedback">Bob Lord</A></FONT></i>
</center>


<H1>

<HR WIDTH="100%"></H1>
<FONT COLOR="#3333FF">(Updated 7/1/98)</FONT>

<h3>Contents</h3>
<DL>
<LI>
<A HREF="#Overview">Overview</A></FONT></LI>

<LI>
<A HREF="#Command Line Arguments">Command Line Interface</A></FONT></LI>

<LI>
<A HREF="#Error Reporting">Error Reporting</A></FONT></LI>

<LI>
<A HREF="#Summary Specfiile">Summary File Format</A></FONT></LI>

<LI>
<A HREF="#Reporter Specfile">Reporter Specification File</A></FONT></LI>

<LI>
<A HREF="#Pseudo-Code">Pseudo-Code,&nbsp; Program Flow</A></FONT></LI>

<LI>
<A HREF="#index.htm format">Format of Generated Index.htm</A></FONT></LI>

<LI>
<A HREF="#Sample Reporter Specfile">Sample Reporter Specfile</A></FONT></LI>

<LI>
<A HREF="#Notes on VRML">Notes on VRML display</A></FONT></LI>

</DL>

<H2>

<HR WIDTH="100%"></H2>

<h3>
<A NAME="Overview"></A></h3>

<h3>
Overview</h3>
<B>Reporter </B>is a productivity tool that automates the web indexing
of regression results generated by the <A HREF="regress.html">regress
</A>tool. The tool takes a specfile (defined below) as input, which
defines the Component/Test Suite/Platform topology of the report directory
structure.&nbsp; The tool then parses all the individual regress summary
files found at the lowest level of the reporting hierarcy and updates all
the intermediate index.html files.&nbsp;&nbsp; The reporter tool is expected
to automate the routine maintenance of updating web content to form an
orderly and predictable testing results web, that can be reindexed automatically.
<BR>&nbsp;
<TABLE BORDER=0 COLS=1 WIDTH="100%" >
<TR>
<TD>
<CENTER><IMG SRC="../reporter.jpg" HEIGHT=672 WIDTH=465>&nbsp;</CENTER>
<B>Figure 1: Architecture Overview</B></TD>
</TR>
</TABLE>

<HR WIDTH="100%">&nbsp;<A NAME="Command Line Arguments"></A>
<BR><B><FONT SIZE=+2>Command Line Arguments</FONT></B>
<BR>&nbsp;
<TABLE COLS=1 WIDTH="100%" >
<TR>
<TD><B>reporter&nbsp; specfile=</B><I>&lt;filename> </I><B>[rptdir=</B><I>&lt;dirname></I><B>]
[debug]</B> <FONT COLOR="#000000"><B>[novrml]</B> <B>[createdirs]</B></FONT>
<LI>
<I>Filename </I>is either an absolute path or relative path to an existing
filename that contains a specification (as defined below).</LI>

<LI>
<I>Dirname </I>is an optional parameter that overrides the dirname line
in the general section of the specification file (see below).</LI>

<LI>
The optional <B>debug </B>argument will turn on stdout debug information
defined below -- soft errors.</LI>

<LI>
<FONT COLOR="#000000">The optional <B>novrml </B>argument will turn OFF
the VRML display option (which creates .wrl files at the root and at the
testsuite levels.)&nbsp;</FONT></LI>

<LI>
<FONT COLOR="#000000">By default, reporter will generate VRML representation
of the reporter tree</FONT><FONT COLOR="#3333FF">.</FONT><FONT COLOR="#000000">&nbsp;
Here is an <A HREF="Root.wrl">example</A>.
[Note: you may view the legend by selecting View: Legend from the view
menu of the cosmo player interface]</FONT></LI>

<LI>
<FONT COLOR="#000000">The optional <B>createdirs</B> will use the reporter
specfile and create the corresponding directory tree.&nbsp;&nbsp; This
is useful for users who are creating the directory tree for the first time,
or have added new component, testsuites or platforms to the specfile. (Reporter
checks for existence of directories before creating them, so old directories
or files are kept intact).</FONT></LI>

<BR><B>Note:</B> The arguments above are order independent.</TD>
</TR>
</TABLE>
&nbsp;
<h3>
<A NAME="Error Reporting"></A></h3>

<h3>
Error Reporting</h3>
The following table defines <B>hard error</B> will will prevent reporter
from completing its task.
<BR>&nbsp;
<TABLE BORDER >
<TR BGCOLOR="#FFCC00">
<TD><B>Error Code</B></TD>

<TD><B>Description</B></TD>
</TR>

<TR>
<TD>NO_ERROR (<B>0</B>)</TD>

<TD>Program ran to completion and completed its indexing job.</TD>
</TR>

<TR>
<TD>ERR_NO_RPTDIR (<B>1</B>)</TD>

<TD>Program could not open the directory <I>rptdir </I>(as defined in [General]
section or passed in on command line).&nbsp;</TD>
</TR>

<TR>
<TD>ERR_NO_SPECFILE (<B>2</B>)</TD>

<TD>Program could not open the specfile passed in on the command line.</TD>
</TR>

<TR>
<TD>ERR_NO_GENERAL (<B>3</B>)</TD>

<TD>Could not locate a [General] section in the specfile.</TD>
</TR>

<TR>
<TD>ERR_NO_RPTDIR (<B>4)</B></TD>

<TD>Could not locate a rptdir= line in the [General] section.&nbsp;&nbsp;
Only if rptdir not passed in on the command line.</TD>
</TR>

<TR>
<TD>ERR_NO_COMPONENT (<B>5</B>)</TD>

<TD>Specification file does not contain a [Component] section.&nbsp;</TD>
</TR>

<TR>
<TD>ERR_NO_TESTSUITE (<B>6</B>)</TD>

<TD>Specification file does not contain a [TestSuite] section.</TD>
</TR>

<TR>
<TD>ERR_NO_PLATFORM (<B>7</B>)</TD>

<TD>Specification file does not contain a [Platform] section.</TD>
</TR>

<TR>
<TD>ERR_IDX_NOWRITE (<B>8</B>)</TD>

<TD>Failed to write (or over-write) one of the index.html files.&nbsp;</TD>
</TR>

<TR>
<TD>ERR_USAGE (<B>9</B>)</TD>

<TD>Provided an invalid or undefined argument. See usage.</TD>
</TR>

<TR>
<TD>ERR_BADSECTIONS (<B>10</B>)</TD>

<TD>One of the required fields in one of the sections was missing.</TD>
</TR>
</TABLE>
The following table defines messages which are generated on standard output
(if and only if debug parameter is supplied) to log <B>"soft"</B> errors
-- errors that can be worked around:
<BR>&nbsp;
<TABLE BORDER >
<TR BGCOLOR="#FFCC00">
<TD><B>Error Message - reported to standard output</B></TD>

<TD><B>Description</B></TD>
</TR>

<TR>
<TD><B>Fatal error: One of the required fields (</B><I>field</I><B>) in
</B><I>&lt;section name></I><B> was not present.</B></TD>

<TD>One of the fields required in provide section was missing, see specification.,
corresponds to the hard error ERR_BADSECTIONS.</TD>
</TR>

<TR>
<TD>r<B>eporter:&nbsp; Malformed summary file</B> <I>&lt;filename></I>
<B>: could not locate</B> <I>&lt;field></I> <B>field.</B></TD>

<TD>The summary file, identified by &lt;filename> did not conform to the
specifiction (see below).</TD>
</TR>

<TR>
<TD><B>reporter: Could not open directory</B><I> &lt;dirname></I> <B>defined
in section</B> <I>&lt;section name></I>.</TD>

<TD>Attempted to open a directory which did not exist.&nbsp; The <B>dirname
</B>variable as composed as follows:&nbsp;
<LI>
For section = [Component-name], dirname = &lt;rptdir>/&lt;component dirname></LI>

<LI>
For section = [TestSuite-name], dirname = &lt;rptdir>/&lt;component dirname>/&lt;testsuite
dirname></LI>

<LI>
For section = [Platform-name], dirname = &lt;rptdir>/&lt;component dirname>/&lt;testsuite
dirname>/&lt;platform dirname></LI>
</TD>
</TR>

<TR>
<TD><B>Fatal error: error code =</B> <I>&lt;number></I> : <I>message</I></TD>

<TD>Additionally, all hard errors will be reported, as defined in the table
above, to standard output., use for all ERR_ codes defined above that don't
have a more specific message defined in this table.</TD>
</TR>

<TR>
<TD>reporter: Usage: <B>reporter&nbsp; specfile=</B><I>&lt;filename> </I><B>[rptdir=</B><I>&lt;dirname></I><B>]
[debug]</B>&nbsp;</TD>

<TD>Corresponds to ERR_USAGE defined above.</TD>
</TR>
</TABLE>
&nbsp;
<h3>
<A NAME="Summary Specfiile"></A></h3>

<h3>
Format of Summary Specification files</h3>
As a regression suite completes (driven by the regress tool), it writes
out an HTML output file, and a regression summary specification file.&nbsp;
Both of these files are utilized in the creation of the higher level summary
index files.

<P><B>The following defines the contents&nbsp; of the reporter summary
specification file, as generated by <A HREF="regress.html">regress</A>:</B>
<BR>&nbsp;
<TABLE BORDER >
<TR BGCOLOR="#FFCC00">
<TD><B>Specification File Element</B></TD>

<TD><B>Description of Element</B></TD>
</TR>

<TR>
<TD><B>[Status]</B></TD>

<TD>Is the only block in this specification file</TD>
</TR>

<TR>
<TD><B>mut=description</B></TD>

<TD>Defines a description for the <B>module under test</B> (e.g., ns/security/lib/crypto
module could be described as "Security Library: Cryptographic Module (lib/crypto)".</TD>
</TR>

<TR>
<TD><B>mutversion=versionstring</B></TD>

<TD>Defines a <B>version string</B> for the collection of tests. It is
assumed that each test will execute against this higher level versionstring
version, and that the results will be reported against this versionstring.</TD>
</TR>

<TR>
<TD><B>platform=&lt;string></B></TD>

<TD>Defines the platform the tests were run under (e.g., HP UX 1.0, Solaris
2.4.1, etc.)</TD>
</TR>

<TR>
<TD><B>pass=&lt;number></B></TD>

<TD>Number of tests that passed.</TD>
</TR>

<TR>
<TD><B>fail=&lt;number></B></TD>

<TD>Number of tests that failed due to non-zero return codes, timeouts,
OR any other abnormality when running the test.</TD>
</TR>

<TR>
<TD><B>knownFail=&lt;number></B></TD>

<TD>Number of tests that were known to fail because a bug number was specified
in its regress specfile.&nbsp;</TD>
</TR>

<TR>
<TD><B>malformed=&lt;number></B></TD>

<TD>Number of tests with bad headers (see <A HREF="regress.html">regress
specfile specifications</A>).</TD>
</TR>
</TABLE>
&nbsp;
<h3>
<A NAME="Reporter Specfile"></A></h3>

<H3>
Format of Reporter Input Specification File</H3>
The following defines the contents of the reporter input specification
file:
<BR>&nbsp;
<TABLE BORDER >
<TR BGCOLOR="#FFCC00">
<TD><B>Section / Field names</B></TD>

<TD><B>Description</B></TD>
</TR>

<TR>
<TD><B>[General]</B>&nbsp;
<BR><B>rptdir=</B><I>&lt;directory></I>&nbsp;
<BR><B>[index=</B><I>filename</I><B>]</B>&nbsp;
<BR><FONT COLOR="#000000"><B>[vrml=</B>[TRUE|FALSE]<B>]</B></FONT></TD>

<TD>
<LI>
The <B>rptdir </B>entry defines the directory location of an existing directory
whose directory topology exists as defined by the [Component-name], [TestSuite-name],
and [Platform-name] sections.&nbsp; The rptdir directory must exist, if
not the command will exit with ERR_NO_RPTDIR.&nbsp; Only a single [General]
section should be provided in a specification file.</LI>

<LI>
If the index entry is present, the filename is the name of the computed
index (e.g., index.html, or index.htm).</LI>

<LI>
<FONT COLOR="#000000">If vrml is set to FALSE, then reporter will NOT generate
VRML representations of&nbsp; the root and each test-suite.&nbsp; By default
vrml is set to TRUE.&nbsp;&nbsp; Also by specifying <B>novrml</B> at the
command line will override vrml=TRUE in the specfile.</FONT></LI>
</TD>
</TR>

<TR>
<TD><B>&nbsp;[Component-</B><I>name</I><B>]</B>&nbsp;
<BR><B>desc=</B><I>&lt;description></I>&nbsp;
<BR><B>version=</B><I>&lt;version></I>&nbsp;
<BR><B>dirname</B><I>=&lt;directory name></I></TD>

<TD>
<LI>
<B>[Component-</B><I>name</I><B>]</B> is a high level component, such as
a complete library.&nbsp; For example, NSPR 2.0 or NETLIB, or the Security
Library.&nbsp; Multiple [Component-name] sections can be present in a specification
file.</LI>

<LI>
<B>desc </B>is a string that describes the component (e.g., Security Library).</LI>

<LI>
<B>version </B>defines the version of the library that the filed reports
should apply to (this is an expected version string)</LI>

<LI>
<B>dirname </B>defines the directory name (no / or .. allowed -- just the
directory name) which is expected to be present under the dirname supplied
in the [General] section or passed in on the command line.</LI>
</TD>
</TR>

<TR>
<TD><B>[TestSuite-<I>name</I>]</B>&nbsp;
<BR><B>desc=</B><I>description</I>&nbsp;
<BR><B>component=</B><I>name</I>&nbsp;
<BR><B>dirname</B><I>=&lt;directory name></I>&nbsp;
<BR>&nbsp;</TD>

<TD>
<LI>
<B>[TestSuite-</B><I>name</I><B>]</B> defines an API test suite (a sub-component)
of the higher level component.&nbsp; For example, in the Security Library,
APIs such as PKCS#5, PKCS#11, certificates/keys will each have their own
indepent test suites (all driven by a different <A HREF="regress.html">regression
</A>specification).&nbsp; Multiple [TestSuite-name] sections can be present,
however component must refer to a provided component name section.</LI>

<LI>
<B>desc </B>is a string that describes the suite (e.g., PKCS#5).&nbsp;</LI>

<LI>
<B>component </B>defines what component name this test suite is contained
in.</LI>

<LI>
<B>dirname </B>defines the directory name (no / or .. allowed -- just the
directory name) which is expected to be present under the &lt;dirname>/&lt;component
name> directory.</LI>
</TD>
</TR>

<TR>
<TD><B>[Platform-</B><I>name</I><B>]</B>&nbsp;
<BR><B>desc=</B><I>description</I>&nbsp;
<BR><B>dirname</B><I>=&lt;directory name></I>&nbsp;
<BR><B>testsuite-</B><I>name=</I><B>yes|no</B></TD>

<TD>
<LI>
<B>[Platform-<I>name</I>]</B> defines what platforms each test suite is
currently available on.&nbsp; It is expected that this mapping is updated
as suites are ported and executed against target platforms.</LI>

<LI>
<B>desc </B>is a string that describes the platform (e.g., Solaris 2.4.1).&nbsp;</LI>

<LI>
<B>dirname </B>defines the directory name (no / or .. allowed -- just the
directory name) which is expected to be present under the &lt;dirname>/&lt;component
name> directory.</LI>

<LI>
<B>testsuite-name</B> is defined to be either yes or no.&nbsp; Yes means
that the TestSuite directory will contain a directory that holds test results
from that <I>name</I> platform</LI>
</TD>
</TR>
</TABLE>
&nbsp;
<h3>
<A NAME="Pseudo-Code"></A></h3>

<h3>
Pseudo-code of reporter program flow</h3>
<B>Data structures:</B>
<BR>&nbsp;
<TABLE COLS=1 WIDTH="100%" >
<TR>
<TD><TT>enum DirNodeType{ DIRROOT, COMPONENT, TSUITE, PLATFORM, FILE} ;&nbsp;</TT>&nbsp;

<P><TT>typedef struct _StatusNode {&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; char *<B>mut</B>;&nbsp; /* module under test
*/&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; char *<B>mutversion</B>;&nbsp; /* module under
test version */&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; char *<B>platform</B>;&nbsp; /* platform string
*/&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; int <B>stats</B>[4] ;&nbsp; /*&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stats[0] = <B>pass</B>;&nbsp;
number of tests passed&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stats[1] = <B>fail</B>;&nbsp;
number of tests failed&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stats[2] = <B>knownfail</B>;&nbsp;&nbsp;
number of tests known to fail&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stats[3] = <B>malformed</B>;&nbsp;&nbsp;
number of malformed tests&nbsp; */&nbsp;</TT>&nbsp;
<BR><TT>} StatusNode;&nbsp;</TT>&nbsp;

<P><TT>typedef struct _DirectoryNode {&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; DirNodeType <B>dntype</B>;&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp; char *<B>name</B>;&nbsp;&nbsp;&nbsp; /*
section name */&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp; char *<B>desc</B>;&nbsp;&nbsp;&nbsp;&nbsp;
/* desc= within a section */&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp; char *<B>dirname</B>;&nbsp; /* dirname=
within a section */&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp; char *<B>mostrecent</B>;&nbsp; /* only
used on dntype = PLATFORM */&nbsp;</TT>&nbsp;
<BR><TT><FONT COLOR="#000000">&nbsp;&nbsp;&nbsp;&nbsp; char *<B>vrmlFileName</B>;
/* for nodes that has a .wrl representation Root, and&nbsp;</FONT>&nbsp;</TT>&nbsp;
<BR><TT><FONT COLOR="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
each testsuite, this field indicates the name of the wrl file*/&nbsp;</FONT>&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp; StatusNode *<B>statnode</B>;&nbsp; /*
The status for the current level */&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp; DirectoryNode *<B>dnlist</B>[];&nbsp;&nbsp;
/* list of pointers */&nbsp;</TT>&nbsp;
<BR><TT>} DirectoryNode;&nbsp;</TT></TD>
</TR>
</TABLE>
<B>Program logic</B>
<BR>&nbsp;
<TABLE>
<TR>
<TD><TT>/* 1.0 Process specification file */&nbsp;</TT>&nbsp;
<BR><TT>Parse command line arguments, on error generate ERR_USAGE, otherwise
set <B>debug</B>, <B>rptdir</B>, <B>specfile </B>variables.&nbsp;</TT>&nbsp;
<BR><TT>Open <B>specfile</B>, if not then&nbsp; ERR_NO_SPECFILE.&nbsp;</TT>&nbsp;
<BR><TT>if index entry in [General Section] set index to filename, otherwise
index = index.html.&nbsp;</TT>&nbsp;
<BR><TT>if no [General Section] then ERR_NO_GENERAL.&nbsp;</TT>&nbsp;
<BR><TT>if <B>rptdir</B>=NULL and no <B>rptdir </B>in [General Section]
then ERR_NO_RPTDIR.&nbsp;</TT>&nbsp;

<P><TT>/* 1.1 Add all component names to DirectoryNode tree */&nbsp;</TT>&nbsp;
<BR><TT>Create DirectoryNode,&nbsp; set as&nbsp; root node, set as type
DIRROOT.&nbsp;</TT>&nbsp;
<BR><TT>Iterate each section name that starts with Component-name {&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; Construct DirectoryNode <B>new</B>, add to root
node, set as <B>dntype = </B>COMPONENT.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; Add<B> name,desc,version, and dirname</B> to
<B>new </B>node.&nbsp;</TT>&nbsp;
<BR><TT>}&nbsp;</TT>&nbsp;

<P><TT>/* 1.2 Add all test suite names to DirectoryNode tree */&nbsp;</TT>&nbsp;
<BR><TT>Iterate each section name that starts with TestSuite-name {&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; Locate component where component-name in section
matches.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; If no match, then print warning message&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; otherwise {&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Construct <B>new </B>DirectoryNode.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set node <B>desc,dirname</B>
values, set as <B>dntype </B>= TESTSUITE&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add <B>new </B>node
to component node <B>dnlist</B>.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; }&nbsp;</TT>&nbsp;
<BR><TT>}&nbsp;</TT>&nbsp;

<P><TT>/* 1.3 Add all test suite names to DirectoryNode tree */&nbsp;</TT>&nbsp;
<BR><TT>Iterate each section name that starts with Platform-name {&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; Locate testsuite where testsuite-name in section&nbsp;
matches.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; If no match, then print warning message&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; otherwise {&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Construct <B>new </B>DirectoryNode.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set node <B>desc,dirname</B>
values, set <B>dntype </B>= PLATFORM.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add <B>new </B>node
to test suite node <B>dnlist</B>.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; }&nbsp;</TT>&nbsp;
<BR><TT>}&nbsp;</TT>&nbsp;

<P><TT>/* 2.0 Open each of the status nodes, and augment tree with HTML
file objects */&nbsp;</TT>&nbsp;
<BR><TT><B>AccumulatedPath </B>= <B>rptdir</B>&nbsp;</TT>&nbsp;
<BR><TT>Select each node <B>n</B>&nbsp; starting from top of tree {&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp; Concatenate <B>dirname </B>to <B>AccumulatedPath</B>.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp; if (<B>n.dntype </B>== PLATFORM) {&nbsp;
/* only look at leaf nodes */&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Open directory
pointed to by <B>AccumulatedPath</B>, and process each <B>file </B>{&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
If <B>file </B>ends in&nbsp; ".htm" or file ends in ".html" {&nbsp; /*
file is a report */&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Is there a corresponding report file? If so {&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Open status file and parse contents into a StatusNode (<B>sn</B>)&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
If status file not malformed {&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Construct a <B>new </B>DirectoryNode.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Set <B>statnode </B>= <B>sn</B>&nbsp;</TT>&nbsp;
<BR><TT><B>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</B>Set <B>dirname </B>as <B>file;&nbsp;&nbsp; /* this should be named
something more abstract than dirname */</B>&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Set node <B>dntype </B>= FILE.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Add <B>node </B>to current node <B>n.dnlist</B>.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
} else print error message&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
else print error message.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; }&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; Remove&nbsp; <B>dirname </B>from <B>AccumulatedPath</B>&nbsp;</TT>&nbsp;
<BR><TT>}&nbsp;</TT>&nbsp;

<P><TT>/* 2.1 Select most recent report at the PLATFORM level and store
in tree */&nbsp;</TT>&nbsp;
<BR><TT>For each <B>node </B>that is a PLATFORM node,&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp; Iterate through the <B>dnlist </B>of FILE nodes and
select the most recent <B>filename </B>(based on string prior to ".").&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set <B>node.most.recent</B> = <B>filename</B>.&nbsp;</TT>&nbsp;

<P><TT>/* 2.2&nbsp; Calculate suite results */&nbsp;</TT>&nbsp;
<BR><TT>For each node that is a TESTSUITE node,&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; Construct new StatusNode, all values zero, set
node.statnode.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; For each PLATFORM node in dnlist,&nbsp; for
each stat, node.stats[i] += platform node stats values.&nbsp;</TT>&nbsp;

<P><TT>/* 2.3 Calculate component results */&nbsp;</TT>&nbsp;
<BR><TT>For each node that is a COMPONENT node,&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; Construct new StatusNode, all values zero,&nbsp;
set node.statnode.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; For each PLATFORM node in dnlist,&nbsp; for
each stat, node.stats[i] += platform node stats values.&nbsp;</TT>&nbsp;

<P><TT>/* TAT.6 create VRML display */&nbsp;</TT>&nbsp;
<BR><TT>if (vrml option is on)&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; Create a CoordNode tree having 1 to 1 correspondence
with the Directory node tree (but up to a certain tree height [currently
set to 2]).&nbsp;&nbsp; Each CoordNode will store the coordinate and color
information to paint the VRML representation.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp; Calculate the 3-D coordinates and color each
Node will have (where a node is a test-suite, or platform, or component
etc.)&nbsp;&nbsp; Color code: <FONT COLOR="#FF0000">RED</FONT> if more
than 50% of tests (under that node) fail or malform, <FONT COLOR="#FF9900">ORANGE</FONT>
if less than 50% of tests fail or malform, <FONT COLOR="#009900">GREEN</FONT>
if all the test pass or are known failures, and YELLOW if the total number
of tests ran is zero.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp; Traverse the CoordNode tree and create the VRML code
(a sphere with label) for each node (also generate the appropriate links).&nbsp;&nbsp;&nbsp;</TT>&nbsp;

<P><TT>&nbsp;&nbsp; By setting the tree height limit to 2 (i.e the tallest
CoordNode tree created will have at most 3 levels), only the root and each
test suite node will be represented by a .wrl file.&nbsp;&nbsp;&nbsp; The
name of the .wrl file at the root is "Root.wrl" and the at each Testsuite
is &lt;testsuitename>.wrl.&nbsp;</TT>&nbsp;

<P><TT>/* 3.0 Write out all index files at ROOT, COMPONENT, SUITE, and
PLATFORM level */&nbsp;</TT>&nbsp;
<BR><TT>for each <B>node </B>in tree do {&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp; switch (<B>node.dntype</B>)&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ROOT:&nbsp;&nbsp; Generate HTML
report from dnlist as per HTML formatting.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp; COMPONENT:&nbsp; Generate HTML report
from dnlist as per HTML formatting.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SUITE:&nbsp;&nbsp; Generate HTML
report from dnlist as per HTML formatting.&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PLATFORM:&nbsp;&nbsp; Generate HTML
report from dnlist as per HTML formatting.&nbsp;</TT>&nbsp;
<BR><TT>}&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;</TT>&nbsp;
<BR><TT>return NO_ERROR.</TT></TD>
</TR>
</TABLE>
&nbsp;
<BR>&nbsp;
<BR><A NAME="index.htm format"></A>
<BR><B><FONT SIZE=+2>Format of generated index.htm files</FONT></B>
<BR>&nbsp;
<TABLE BORDER >
<TR BGCOLOR="#FFCC00">
<TD><B>Level</B></TD>

<TD><B>HTML Format</B></TD>
</TR>

<TR>
<TD><TT>ROOT</TT></TD>

<TD><TT>&lt;HTML>&nbsp;</TT>&nbsp;
<BR><TT>&lt;HEAD>&lt;/TITLE>&lt;/TITLE>&lt;/HEAD>&nbsp;</TT>&nbsp;
<BR><TT>&lt;BODY>&nbsp;</TT>&nbsp;
<BR><TT>&lt;TABLE>&nbsp;</TT>&nbsp;
<BR><TT>For each component in ROOT {&nbsp;</TT>&nbsp;
<BR><TT>&lt;TR>&lt;TD>&lt;A HREF="&lt;filename>/&lt;index>">desc&lt;/A>&lt;/TD>&lt;/TR>&nbsp;</TT>&nbsp;
<BR><TT>}&nbsp;</TT>&nbsp;
<BR><TT>&lt;/TABLE>&nbsp;</TT>&nbsp;
<BR><TT>&lt;/BODY>&nbsp;</TT>&nbsp;
<BR><TT>&lt;/HTML></TT></TD>
</TR>

<TR>
<TD><TT>COMPONENT</TT></TD>

<TD><TT>&lt;HTML>&nbsp;</TT>&nbsp;
<BR><TT>&lt;HEAD>&lt;/TITLE>&lt;/TITLE>&lt;/HEAD>&nbsp;</TT>&nbsp;
<BR><TT>&lt;BODY>&nbsp;</TT>&nbsp;
<BR><TT>&lt;TABLE>&nbsp;</TT>&nbsp;
<BR><TT>For each suite in component node {&nbsp;</TT>&nbsp;
<BR><TT>&lt;TR>&lt;TD>&lt;A HREF="&lt;filename>/&lt;index>">desc&lt;/A>&lt;/TD>&lt;/TR>&nbsp;</TT>&nbsp;
<BR><TT>}&nbsp;</TT>&nbsp;
<BR><TT>&lt;/TABLE>&nbsp;</TT>&nbsp;
<BR><TT>&lt;/BODY>&nbsp;</TT>&nbsp;
<BR><TT>&lt;/HTML></TT></TD>
</TR>

<TR>
<TD><TT>SUITE</TT></TD>

<TD><TT>&lt;HTML>&nbsp;</TT>&nbsp;
<BR><TT>&lt;HEAD>&lt;/TITLE>&lt;/TITLE>&lt;/HEAD>&nbsp;</TT>&nbsp;
<BR><TT>&lt;BODY>&nbsp;</TT>&nbsp;
<BR><TT>&lt;TABLE>&nbsp;</TT>&nbsp;
<BR><TT>&lt;TR>&lt;TD>&lt;/TD>&lt;/TR>&nbsp;</TT>&nbsp;
<BR><TT>&lt;/TABLE>&nbsp;</TT>&nbsp;
<BR><TT>&lt;/BODY>&nbsp;</TT>&nbsp;
<BR><TT>&lt;/HTML></TT></TD>
</TR>

<TR>
<TD><TT>PLATFORM</TT></TD>

<TD><TT>&lt;HTML>&nbsp;</TT>&nbsp;
<BR><TT>&lt;HEAD>&lt;/TITLE>&lt;/TITLE>&lt;/HEAD>&nbsp;</TT>&nbsp;
<BR><TT>&lt;BODY>&nbsp;</TT>&nbsp;
<BR><TT>&lt;TABLE>&nbsp;</TT>&nbsp;
<BR><TT>&lt;TR>&lt;TD>&lt;/TD>&lt;/TR>&nbsp;</TT>&nbsp;
<BR><TT>&lt;/TABLE>&nbsp;</TT>&nbsp;
<BR><TT>&lt;/BODY>&nbsp;</TT>&nbsp;
<BR><TT>&lt;/HTML></TT></TD>
</TR>
</TABLE>
&nbsp;
<h3>
<A NAME="Sample Reporter Specfile"></A></h3>

<h3>
Sample Reporter input specification file</h3>
The following defines a sample input specification file to reporter (which
is highly domain specific):
<BR>&nbsp;
<TABLE BORDER=0 WIDTH="100%" >
<TR>
<TD><TT>[General]&nbsp;</TT>&nbsp;
<BR><TT>dirname=/u/jhines/saw/projects/hardcore/prj-ttools/testing/rptroot&nbsp;</TT>&nbsp;

<P><TT>[Component-seclib]&nbsp;</TT>&nbsp;
<BR><TT>desc=Security Library&nbsp;</TT>&nbsp;
<BR><TT>version=2.0&nbsp;</TT>&nbsp;
<BR><TT>dirname=security-library&nbsp;</TT>&nbsp;

<P><TT>[TestSuite-pkcs5]&nbsp;</TT>&nbsp;
<BR><TT>desc=Public Key Cryptography Standards # 5&nbsp;</TT>&nbsp;
<BR><TT>component=seclib&nbsp;</TT>&nbsp;
<BR><TT>dirname=pkcs5&nbsp;</TT>&nbsp;

<P><TT>[TestSuite-crypto]&nbsp;</TT>&nbsp;
<BR><TT>desc=Cryptographic Functionality (bulk ciphers, RSA, DSA)&nbsp;</TT>&nbsp;
<BR><TT>component=seclib&nbsp;</TT>&nbsp;
<BR><TT>dirname=libcrypto&nbsp;</TT>&nbsp;

<P><TT>[Platform=hp10_2]&nbsp;</TT>&nbsp;
<BR><TT>desc=HP UX 10.2&nbsp;</TT>&nbsp;
<BR><TT>dirname=hpux10_2&nbsp;</TT>&nbsp;
<BR><TT>testsuite-pkcs5=yes&nbsp;</TT>&nbsp;
<BR><TT>testsuite-crypto=yes&nbsp;</TT>&nbsp;

<P><TT>[Platform=sol2_4]&nbsp;</TT>&nbsp;
<BR><TT>desc=Solaris 2.4.1&nbsp;</TT>&nbsp;
<BR><TT>dirname=sol2_4_1&nbsp;</TT>&nbsp;
<BR><TT>testsuite-pkcs5=yes</TT></TD>
</TR>
</TABLE>
&nbsp;
<BR><A NAME="Notes on VRML"></A>
<BR><B><FONT SIZE=+1>Notes on the VRML display:</FONT></B>
<BR>&nbsp;
<LI>
<TT>When viewing with Cosmo player, use the 'seek' button to focus on a
desired node.</TT></LI>

<LI>
<TT>To view the legend, select <B>View: Legend</B> from the Views menu</TT></LI>

<LI>
<TT>At the bottom most level (regress generated results), all nodes should
appear in a line along the z plane (along the line of sight).&nbsp; The
nodes are sorted alphanumerically in increasing order from back to front.&nbsp;
The effect this acheives is that when dates are the labels for these nodes,
the most current node will appear closest to the viewer. Hence, the user
can easily pick out the most current results.</TT></LI>

<LI>
<TT>Nodes which have have failure underneath it are closer to the viewer
than nodes that are all PASS (i.e. red and orange nodes appear closer,
where as green nodes appear farther.)</TT></LI>


<P><TT>All the code necessary to implement VRML display is packaged in
the files:</TT>
<BR><TT>&nbsp;&nbsp;&nbsp; genvrml.h&nbsp; genvrml.c</TT>
<BR><TT>genvrml.h contains c preprocessor CONSTANTS that may be changed
to alter the VRML display.&nbsp; Below is a list of constants and their
purpose:</TT>
<BR>&nbsp;
<TABLE BORDER COLS=2 WIDTH="100%" >
<TR BGCOLOR="#FFCC00">
<TD><B><TT><FONT COLOR="#000000">Constant</FONT></TT></B></TD>

<TD><B><TT><FONT COLOR="#000000">Function</FONT></TT></B></TD>
</TR>

<TR>
<TD><TT>LINE_SHININESS</TT></TD>

<TD><TT>defines the brightness with which the lines interconnecting nodes
appear.&nbsp; Currently set to 1.0 (the maximum).&nbsp;&nbsp; Value can
range from 0.0 to 1.0</TT></TD>
</TR>

<TR>
<TD><TT>X_ORIGIN, Y_ORIGIN, Z_ORIGIN</TT></TD>

<TD><TT>defines the default origin.</TT></TD>
</TR>

<TR>
<TD><TT>NODE_RADIUS</TT></TD>

<TD><TT>defines the radius of each sphere/node</TT></TD>
</TR>

<TR>
<TD><TT>CAPTION_X_OFFSET, CAPTION_Y_OFFSET</TT></TD>

<TD><TT>defines the offset in both x and y directions from the top of each
sphere/node with which label text is to be drawn</TT></TD>
</TR>

<TR>
<TD><TT>FONT_STYLE, FONT_SIZE, FONT_FAMILY</TT></TD>

<TD><TT>Font attributes for the test label above each node</TT></TD>
</TR>

<TR>
<TD><TT>MAGIC_NUMBER</TT></TD>

<TD><TT>The cotagent of an angle (which should be half of the total angle
of view).&nbsp; i.e. if an angle of view of 90 degrees is desired, then
set MAGIC_NUMBER to cotan(45degrees)</TT></TD>
</TR>

<TR>
<TD><TT>LEVEL_SPAN</TT></TD>

<TD><TT>The distance between nodes in each level in the tree. (This is
displacement along the y-axis).</TT></TD>
</TR>

<TR>
<TD><TT>LEAF_SPAN</TT></TD>

<TD><TT>The distance between each bottom most leaf in the displayed tree.</TT>&nbsp;
<BR><TT>All leaves have equal (x axis) spacing between them that is defined
by this constant.</TT></TD>
</TR>

<TR>
<TD><TT>Z_SPAN</TT></TD>

<TD><TT>The distance of displacement between nodes on the Z axis.</TT></TD>
</TR>
</TABLE>
&nbsp;
<h3>
<A NAME="Feedback"></A></h3>



<?
require_once "{$config['file_root']}/includes/footer.inc.php"
?>
