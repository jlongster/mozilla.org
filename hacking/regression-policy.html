<?php

$html_title = 'Performance Regressions Policy';
$page_title = 'Performance Regressions Policy';

$menu = array(
    'id' => 'about',
);

$breadcrumbs = array(
    '/about/' => 'About Mozilla',
    '/about/policies/' => 'Policies',
);

require_once "{$config['file_root']}/includes/header.inc.php"

?>

<p>In this document:</p>

<ul class="toc">
  <li><a href="#Basic_Policy">Basic Policy</a>: The tree is to be closed in 
  response to serious performance regressions.</li>

  <li><a href="#Implementation">Implementation</a>: When the tree is to be closed 
  and how it is to be reopened.</li>

  <li><a href="#New_Features">New Features vs. Performance</a>: Potential approaches 
  for a valuable new feature that causes performance regressions.</li>

  <li><a href="#Footprint_Increases">Footprint Increases</a>: Tree closure policy 
  not applicable.</li>
</ul>

<h3><a name="Basic_Policy">Basic Policy: Tree Closure</a></h3>
  <p>Performance is 
  a critical goal for Mozilla releases and the commercial products that will be 
  based on Mozilla. We cannot allow performance regressions to go unnoticed or 
  unresolved during our development cycles. Yet our automated tools are of only 
  limited help in determining the cause of performance regressions. The sheriffs 
  are the first line of defense and those monitoring the tree must take an active 
  stance in responding to performance regressions. We have therefore implemented 
  a policy of tree closure for serious performance regressions.</p>

<h3><a name="Implementation">Implementation</a></h3> 

<p>Performance regressions are 
measured against the numbers reported on tinderbox by various regression tests 
including tests for startup time (Ts), pageload (Tp), and new window open (Txul). 
These tests are run on several machines with varying processor speeds and memory 
configurations. When a performance regression appears that is "bad enough,&quot;* 
then</p>

<ul>
  <li>The tree is to be closed
  <ul>
    <li>Those on the hook are on the hook - it's the job of each person on the 
      hook to figure out whether his or her check-in caused the problem. </li>
  </ul>
  <ul>
    <li>The hook gets one hour. </li>
  </ul>
  <ul>
    <li>Those on the hook may exonerate their individual check-ins through an 
      explanation as to why their code is not the problem (e.g., my code doesn't 
      run at start-up for a regression in start-up performance). To be effective, 
      the explanation must be convincing to the sheriff and the performance gurus.</li>
  </ul>
  </li>
  <li>Starting on the 61st minute, checkins that have not been exonerated are 
    backed out by the sheriff </li>
  <li>If there is no good idea as to what caused the problem, then
  <ul>
    <li>the tree remains closed </li>
    <li>everyone is backed out</li>
  </ul>
  <ul>
    <li>those who were backed out are allowed to check-in only through a metering 
      process. The sheriff decides the check-in order. </li>
  </ul>
  </li>
  <li>If there is a reasonable idea about what caused the problem, then
  <ul>
    <li>the suspect checkin is backed out</li>
    <li>we wait for the tinderboxen to cycle and verify that the regression is 
      fixed</li>
    <li>the tree is opened </li>
  </ul>
  </li>
</ul>

<p> <b>*</b> We have not tried to define "bad enough." We believe that the sheriff 
  in conjunction with performance gurus, super-reviewers, mozilla.org staff and 
  concerned developers will be able to determine when a regression is bad enough. 
  If it turns out a significant number of these decisions are controversial, then 
  mozilla.org staff will look at creating more precise guidelines, and will use 
  the experiences gained with this current policy to create a more detailed one. 
  So please, do not attack the sheriffs for personal disagreement over what is 
  bad enough. We expect sheriffs to do their best, to get input from the relevant 
  people and to act when appropriate. We expect post-mortems regarding what was 
  backed out, when, why, and how we might proceed better the next time. We expect 
  civil discussion. We do not expect our sheriffs to be the subject of virulent 
  attacks because they did or did not back out a particular check-in. </p>

<h3><a name="New_Features">New Features vs. Performance</a></h3>
<p> It may happen 
  that a highly desirable feature results in a performance regression. In that 
  case, those wishing to include the feature in Mozilla ought to do the following. 
  Enlist help to reduce the performance degradation as much as possible. Repeat 
  this step. Evaluate how important the feature really is. Be brutal. If the feature 
  is important only to a few, the case for accepting a performance regression 
  will be very hard. If the feature is important to a significant number of users, 
  then start a discussion with drivers@mozilla.org about the value of your feature 
  and why it is important enough to warrant a performance regression. Your chances 
  of success will go way up if you can fix an equivalent performance bug or find 
  a way to separate out another feature that has a similar performance cost. Even 
  small declines in performance add up, so expect to have to work hard to justify 
  regressions.</p>

<h3><a name="Footprint_Increases">Footprint Increases</a></h3>
  <p>This policy does 
  not apply to unexpected increases in Mozilla's footprint. Staff feels that the 
  cause of bloat and leaks has not been so difficult to identify, and so this 
  policy is not required. </p>

<p><b>Contact</b>: Mitchell Baker &lt;<a href="mailto:mitchell@mozilla.org">mitchell@mozilla.org</a>&gt; 
</p>


<?
require_once "{$config['file_root']}/includes/footer.inc.php"
?>
